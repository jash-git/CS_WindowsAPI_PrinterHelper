<!DOCTYPE html>
<!-- saved from url=(0046)https://www.cnblogs.com/sntetwt/p/9730408.html -->
<html lang="zh-TW" style="--olcb-folder-code-block-max-height:80vh;" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin-when-cross-origin">
    <meta name="description" content="打印示例： StringBuilder builder = new StringBuilder();builder.AppendLine(&amp;quot; 打印测试 &amp;quot;);string Prin">
    <meta property="og:description" content="打印示例： StringBuilder builder = new StringBuilder();builder.AppendLine(&amp;quot; 打印测试 &amp;quot;);string Prin">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園</title>
    <link id="favicon" rel="shortcut icon" href="https://common.cnblogs.com/favicon.svg" type="image/svg+xml">
    
    <style>#home :not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([highlighted]):not([class*="brush:"]) code:not(.hljs), :not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([highlighted]):not([class*="brush:"]) code:not(.hljs) {background: rgb(245, 245, 245);
        padding: 12px;
        border: 1px solid rgb(204, 204, 204);
        border-radius: 3px;
        border-color: transparent;
        color: rgb(68, 68, 68);
        font-family: "Courier New", sans-serif;
        font-size: 12px</style><link rel="stylesheet" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/blog-common.min.css">
    

    <link id="MainCss" rel="stylesheet" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/bundle-codinglife.min.css">
        <link id="highlighter-theme-cnblogs" type="text/css" rel="stylesheet" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/cnblogs.css">
    <link type="text/css" rel="stylesheet" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/custom.css">
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/bundle-codinglife-mobile.min.css">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/sntetwt/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/sntetwt/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/sntetwt/wlwmanifest.xml">
    <script type="text/javascript" async="" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/analytics.js.下載"></script><script>
        var currentBlogId = 84861;
        var currentBlogApp = 'sntetwt';
        var isLogined = false;
        var isBlogOwner = false;
        var skinName = 'CodingLife';
        var visitorUserId = '';
        var hasCustomScript = true;
        try {
            if (hasCustomScript && document.referrer && document.referrer.indexOf('baidu.com') >= 0) {
                Object.defineProperty(document, 'referrer', { value: '' });
                Object.defineProperty(Document.prototype, 'referrer', { get: function(){ return ''; } });
            }
        } catch(error) { }
        window.cb_enable_mathjax = true;
        window.mathEngine = 0;
        window.codeHighlightEngine = 1;
        window.enableCodeLineNumber = false;
        window.codeHighlightTheme = 'cnblogs';
        window.darkModeCodeHighlightTheme = 'vs2015';
        window.isDarkCodeHighlightTheme = false;
        window.isDarkModeCodeHighlightThemeDark = true;
        window.isDisableCodeHighlighter = false;
        window.enableCodeThemeTypeFollowSystem = false;
    </script>
        <script>
            var currentPostDateAdded = '2018-09-30 15:55';
        </script>
    <script src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/jquery-2.2.0.min.js.下載"></script>
    <script src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/blog-common.min.js.下載"></script><style>.medium-zoom-overlay {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  opacity: 0;
  transition: opacity 300ms;
  will-change: opacity;
}

.medium-zoom--opened .medium-zoom-overlay {
  cursor: pointer;
  cursor: zoom-out;
  opacity: 1;
}

.medium-zoom-image {
  cursor: pointer;
  cursor: zoom-in;
  /*
    The `transition` is marked as "!important" for the animation to happen
    even though it's overriden by another inline `transition` style attribute.

    This is problematic with frameworks that generate inline styles on their
    images (e.g. Gatsby).

    See https://github.com/francoischalifour/medium-zoom/issues/110
   */
  transition: transform 300ms cubic-bezier(0.2, 0, 0.2, 1) !important;
}

.medium-zoom-image--hidden {
  visibility: hidden;
}

.medium-zoom-image--opened {
  position: relative;
  cursor: pointer;
  cursor: zoom-out;
  will-change: transform;
}
</style><script id="hljs-script" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/highlight.min.js.下載" type="text/javascript" async=""></script>
    

    
<meta http-equiv="origin-trial" content="Az6AfRvI8mo7yiW5fLfj04W21t0ig6aMsGYpIqMTaX60H+b0DkO1uDr+7BrzMcimWzv/X7SXR8jI+uvbV0IJlwYAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjgwNjUyNzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A+USTya+tNvDPaxUgJooz+LaVk5hPoAxpLvSxjogX4Mk8awCTQ9iop6zJ9d5ldgU7WmHqBlnQB41LHHRFxoaBwoAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjgwNjUyNzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A7FovoGr67TUBYbnY+Z0IKoJbbmRmB8fCyirUGHavNDtD91CiGyHHSA2hDG9r9T3NjUKFi6egL3RbgTwhhcVDwUAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjgwNjUyNzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><script src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/pubads_impl_2022120801.js.下載" async=""></script><link rel="preload" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/f.txt" as="script"><script type="text/javascript" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/f.txt"></script><link rel="preload" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/f(1).txt" as="script"><script type="text/javascript" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/f(1).txt"></script><script id="mathjax" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/MathJax.js.下載" type="text/javascript" defer=""></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link type="text/css" rel="stylesheet" charset="UTF-8" href="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/translateelement.css"></head>
<body class="skin-codinglife has-navbar mathjax2"><div id="MathJax_Message" style="display: none;"></div>
<a name="top"></a>
<div id="top_nav" class="navbar forpc">
    <nav id="nav_main" class="navbar-main">
        <ul id="nav_left" class="navbar-list navbar-left">
            <li class="navbar-branding">
                <a href="https://www.cnblogs.com/" title="開發者的網上家園" role="banner">
                    <img src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/logo.svg" alt="博客園Logo">
                </a>
            </li>
            <li>
                <a href="https://www.cnblogs.com/" onclick="countClicks(&#39;skin-navbar-sitehome&#39;)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首頁</font></font></a>
            </li>
            <li>
                <a href="https://news.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-news&#39;)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新聞</font></font></a>
            </li>
            <li>
                <a href="https://q.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-q&#39;)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">博問</font></font></a>
            </li>
            <li>
                <a id="nav_brandzone" href="https://brands.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-brands&#39;)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">專區</font></font></a>
            </li>
            <li>
                <a href="https://ing.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-ing&#39;)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">閃存</font></font></a>
            </li>
            <li>
                <a href="https://edu.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-edu&#39;)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">班級</font></font></a>
            </li>
        </ul>
        <ul id="nav_right" class="navbar-list navbar-right">
            <li>
                <form id="zzk_search" class="navbar-search" action="https://zzk.cnblogs.com/s" method="get" role="search">
                    <input name="w" id="zzk_search_input" placeholder="代碼改變世界" type="search" tabindex="3">
                    <button type="submit" id="zzk_search_button">
                        <img src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/search.svg" alt="搜索">
                    </button>
                </form>
            </li>
            <li id="navbar_login_status" class="navbar-list">
                <a class="navbar-user-info navbar-blog" href="https://i.cnblogs.com/EditPosts.aspx?opt=1" alt="寫隨筆" title="寫隨筆" style="display: none;">
                    <img id="new_post_icon" class="navbar-icon" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/newpost.svg" alt="寫隨筆">
                </a>
                <a id="navblog-myblog-icon" class="navbar-user-info navbar-blog" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx" alt="我的博客" title="我的博客" style="display: none;">
                    <img id="myblog_icon" class="navbar-icon" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/myblog.svg" alt="我的博客">
                </a>
                <a class="navbar-user-info navbar-message navbar-icon-wrapper" href="https://msg.cnblogs.com/" alt="短消息" title="短消息" style="display: none;">
                    <img id="msg_icon" class="navbar-icon" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/message.svg" alt="短消息">
                    <span id="msg_count" style="display: none"></span>
                </a>
                <a id="navbar_lite_mode_indicator" data-current-page="blog" style="display: none" href="javascript:void(0)" alt="簡潔模式" title="簡潔模式啟用，您在訪問他人博客時會使用簡潔款皮膚展示">
                    <img class="navbar-icon" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/lite-mode-on.svg" alt="簡潔模式">
                </a>
                <div id="user_info" class="navbar-user-info dropdown" style="display: none;">
                    <a class="dropdown-button" href="https://home.cnblogs.com/">
                        <img id="user_icon" class="navbar-avatar" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/avatar-default.svg" alt="用戶頭像">
                    </a>
                    <div class="dropdown-menu">
                        <a id="navblog-myblog-text" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的博客</font></font></a>
                        <a href="https://home.cnblogs.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的園子</font></font></a>
                        <a href="https://account.cnblogs.com/settings/account"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">賬號設置</font></font></a>
                        <a href="javascript:void(0)" id="navbar_lite_mode_toggle" title="簡潔模式會使用簡潔款皮膚顯示所有博客"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    簡潔模式</font></font><img id="navbar_lite_mode_on" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/lite-mode-check.svg" class="hide"><span id="navbar_lite_mode_spinner" class="hide"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></span>
</a>
                        <a href="javascript:void(0)" onclick="account.logout();"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">退出登錄</font></font></a>
                    </div>
                </div>
                <a class="navbar-anonymous" href="https://account.cnblogs.com/signup" style="display: inline;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">註冊</font></font></a>
                <a class="navbar-anonymous" href="javascript:void(0);" onclick="account.login()" style="display: inline;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登錄</font></font></a>
            </li>
        </ul>
    </nav>
</div>



<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
        <a id="lnkBlogLogo" href="https://www.cnblogs.com/sntetwt/"><img id="blogLogo" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/logo.gif" alt="返回主頁"></a>		
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/sntetwt/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sntetwt</font></font></a>
</h1>
<h2></h2>




		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
博客園</font></font></a>
</li>
<li>
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/sntetwt/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首頁</font></font></a>
</li>
<li>

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新隨筆</font></font></a>
</li>
<li>
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/microsoftzhcn"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
聯繫</font></font></a></li>
<li>
<a id="blog_nav_rss" class="menu" href="javascript:void(0)" data-rss="https://www.cnblogs.com/sntetwt/rss/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
訂閱</font></font></a>
<!--<partial name="./Shared/_XmlLink.cshtml" model="Model" /></li>--></li>
<li>
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
管理</font></font></a>
</li>
</ul>


		<div class="blogStats">
			<span id="stats_post_count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">隨筆- 587&nbsp; </font></font></span>
<span id="stats_article_count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章- 1&nbsp; </font></font></span>
<span id="stats-comment_count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">評論- 56&nbsp; </font></font></span>
<span id="stats-total-view-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">閱讀- 
 </font></font><span title="總閱讀數: 1584393"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
158萬</font></font></span></span>

		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->
<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		<div id="post_detail">
    <!--done-->
    <div id="topics">
        <div class="post">
            <h1 class="postTitle">
                
<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/sntetwt/p/9730408.html">
    <span role="heading" aria-level="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C#調用系統打印機和收銀錢箱</font></font></span>
    
</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打印示例：</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StringBuilder builder = new StringBuilder(); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">builder.AppendLine("--------------打印測試--------------"); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string PrintName = PrinterHelper.GetDeaultPrinterName(); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PrinterHelper.SendStringToPrinter(PrintName, builder.ToString());</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資源文件：</font></font><strong><a id="" href="https://files.cnblogs.com/files/sntetwt/%E8%B5%84%E6%B1%9F58%E3%80%8180%E6%89%93%E5%8D%B0%E6%9C%BA%E9%A9%B1%E5%8A%A8.rar" rel="noopener"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資江58、80打印機驅動.rar</font></font></a></strong></p>
<div class="cnblogs_Highlighter">
<div><div id="highlighter_155749" class="syntaxhighlighter  nogutter  csharp"><div class="toolbar"><span><a href="https://www.cnblogs.com/sntetwt/p/9730408.html#" class="toolbar_item command_expandSource expandSource"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ View Code</font></font></a></span><span><a href="https://www.cnblogs.com/sntetwt/p/9730408.html#" class="toolbar_item command_help help"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?</font></font></a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">using</code> <code class="csharp plain">System;</code></div><div class="line number2 index1 alt1"><code class="csharp keyword">using</code> <code class="csharp plain">System.IO;</code></div><div class="line number3 index2 alt2"><code class="csharp keyword">using</code> <code class="csharp plain">System.Text;</code></div><div class="line number4 index3 alt1"><code class="csharp keyword">using</code> <code class="csharp plain">System.Runtime.InteropServices;</code></div><div class="line number5 index4 alt2"><code class="csharp keyword">using</code> <code class="csharp plain">System.Security;</code></div><div class="line number6 index5 alt1"><code class="csharp keyword">using</code> <code class="csharp plain">System.ComponentModel;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="csharp keyword">namespace</code> <code class="csharp plain">Micro.Common</code></div><div class="line number9 index8 alt2"><code class="csharp plain">{</code></div><div class="line number10 index9 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number11 index10 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 打印功能</code></div><div class="line number12 index11 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number13 index12 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">class</code> <code class="csharp plain">PrinterHelper</code></div><div class="line number14 index13 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number15 index14 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">private</code> <code class="csharp plain">PrinterHelper() { }</code></div><div class="line number16 index15 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region API声明</code></div><div class="line number17 index16 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]</code></div><div class="line number18 index17 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">struct</code> <code class="csharp plain">structPrinterDefaults</code></div><div class="line number19 index18 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number20 index19 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.LPTStr)]</code></div><div class="line number21 index20 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">String pDatatype;</code></div><div class="line number22 index21 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">IntPtr pDevMode;</code></div><div class="line number23 index22 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I4)]</code></div><div class="line number24 index23 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">DesiredAccess;</code></div><div class="line number25 index24 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">};</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"OpenPrinter"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Unicode, ExactSpelling = </code><code class="csharp keyword">false</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number28 index27 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">OpenPrinter([MarshalAs(UnmanagedType.LPTStr)] </code><code class="csharp keyword">string</code> <code class="csharp plain">printerName, </code><code class="csharp keyword">out</code> <code class="csharp plain">IntPtr phPrinter, </code><code class="csharp keyword">ref</code> <code class="csharp plain">structPrinterDefaults pd);</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"ClosePrinter"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Unicode, ExactSpelling = </code><code class="csharp keyword">false</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number31 index30 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">ClosePrinter(IntPtr phPrinter);</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]</code></div><div class="line number34 index33 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">struct</code> <code class="csharp plain">structSize</code></div><div class="line number35 index34 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number36 index35 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">Int32 width;</code></div><div class="line number37 index36 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">Int32 height;</code></div><div class="line number38 index37 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]</code></div><div class="line number41 index40 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">struct</code> <code class="csharp plain">structRect</code></div><div class="line number42 index41 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number43 index42 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">Int32 left;</code></div><div class="line number44 index43 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">Int32 top;</code></div><div class="line number45 index44 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">Int32 right;</code></div><div class="line number46 index45 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">Int32 bottom;</code></div><div class="line number47 index46 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Explicit, CharSet = CharSet.Unicode)]</code></div><div class="line number50 index49 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">struct</code> <code class="csharp plain">FormInfo1</code></div><div class="line number51 index50 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number52 index51 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[FieldOffset(0), MarshalAs(UnmanagedType.I4)]</code></div><div class="line number53 index52 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">Flags;</code></div><div class="line number54 index53 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[FieldOffset(4), MarshalAs(UnmanagedType.LPWStr)]</code></div><div class="line number55 index54 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">String pName;</code></div><div class="line number56 index55 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[FieldOffset(8)]</code></div><div class="line number57 index56 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">structSize Size;</code></div><div class="line number58 index57 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[FieldOffset(16)]</code></div><div class="line number59 index58 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">structRect ImageableArea;</code></div><div class="line number60 index59 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">};</code></div><div class="line number61 index60 alt2">&nbsp;</div><div class="line number62 index61 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]</code></div><div class="line number63 index62 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">struct</code> <code class="csharp plain">structDevMode</code></div><div class="line number64 index63 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number65 index64 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]</code></div><div class="line number66 index65 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">String</code></div><div class="line number67 index66 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">dmDeviceName;</code></div><div class="line number68 index67 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U2)]</code></div><div class="line number69 index68 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmSpecVersion;</code></div><div class="line number70 index69 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U2)]</code></div><div class="line number71 index70 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmDriverVersion;</code></div><div class="line number72 index71 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U2)]</code></div><div class="line number73 index72 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmSize;</code></div><div class="line number74 index73 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U2)]</code></div><div class="line number75 index74 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmDriverExtra;</code></div><div class="line number76 index75 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number77 index76 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmFields;</code></div><div class="line number78 index77 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number79 index78 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmOrientation;</code></div><div class="line number80 index79 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number81 index80 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmPaperSize;</code></div><div class="line number82 index81 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number83 index82 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmPaperLength;</code></div><div class="line number84 index83 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number85 index84 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmPaperWidth;</code></div><div class="line number86 index85 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number87 index86 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmScale;</code></div><div class="line number88 index87 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number89 index88 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmCopies;</code></div><div class="line number90 index89 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number91 index90 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmDefaultSource;</code></div><div class="line number92 index91 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number93 index92 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmPrintQuality;</code></div><div class="line number94 index93 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number95 index94 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmColor;</code></div><div class="line number96 index95 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number97 index96 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmDuplex;</code></div><div class="line number98 index97 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number99 index98 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmYResolution;</code></div><div class="line number100 index99 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number101 index100 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmTTOption;</code></div><div class="line number102 index101 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.I2)]</code></div><div class="line number103 index102 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmCollate;</code></div><div class="line number104 index103 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)]</code></div><div class="line number105 index104 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">String dmFormName;</code></div><div class="line number106 index105 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U2)]</code></div><div class="line number107 index106 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">short</code> <code class="csharp plain">dmLogPixels;</code></div><div class="line number108 index107 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number109 index108 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmBitsPerPel;</code></div><div class="line number110 index109 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number111 index110 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmPelsWidth;</code></div><div class="line number112 index111 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number113 index112 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmPelsHeight;</code></div><div class="line number114 index113 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number115 index114 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmNup;</code></div><div class="line number116 index115 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number117 index116 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmDisplayFrequency;</code></div><div class="line number118 index117 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number119 index118 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmICMMethod;</code></div><div class="line number120 index119 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number121 index120 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmICMIntent;</code></div><div class="line number122 index121 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number123 index122 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmMediaType;</code></div><div class="line number124 index123 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number125 index124 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmDitherType;</code></div><div class="line number126 index125 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number127 index126 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmReserved1;</code></div><div class="line number128 index127 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.U4)]</code></div><div class="line number129 index128 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">int</code> <code class="csharp plain">dmReserved2;</code></div><div class="line number130 index129 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number131 index130 alt2">&nbsp;</div><div class="line number132 index131 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]</code></div><div class="line number133 index132 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">struct</code> <code class="csharp plain">PRINTER_INFO_9</code></div><div class="line number134 index133 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number135 index134 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">IntPtr pDevMode;</code></div><div class="line number136 index135 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number137 index136 alt2">&nbsp;</div><div class="line number138 index137 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"AddFormW"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Unicode, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">,</code></div><div class="line number139 index138 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number140 index139 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">AddForm(IntPtr phPrinter, [MarshalAs(UnmanagedType.I4)] </code><code class="csharp keyword">int</code> <code class="csharp plain">level, </code><code class="csharp keyword">ref</code> <code class="csharp plain">FormInfo1 form);</code></div><div class="line number141 index140 alt2">&nbsp;</div><div class="line number142 index141 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"DeleteForm"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Unicode, ExactSpelling = </code><code class="csharp keyword">false</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall),</code></div><div class="line number143 index142 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number144 index143 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">DeleteForm(IntPtr phPrinter, [MarshalAs(UnmanagedType.LPTStr)] </code><code class="csharp keyword">string</code> <code class="csharp plain">pName);</code></div><div class="line number145 index144 alt2">&nbsp;</div><div class="line number146 index145 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"kernel32.dll"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"GetLastError"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">false</code><code class="csharp plain">, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number147 index146 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp plain">Int32 GetLastError();</code></div><div class="line number148 index147 alt1">&nbsp;</div><div class="line number149 index148 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"GDI32.dll"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"CreateDC"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Unicode, ExactSpelling = </code><code class="csharp keyword">false</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number150 index149 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp plain">IntPtr CreateDC([MarshalAs(UnmanagedType.LPTStr)] </code><code class="csharp keyword">string</code> <code class="csharp plain">pDrive, [MarshalAs(UnmanagedType.LPTStr)] </code><code class="csharp keyword">string</code> <code class="csharp plain">pName, [MarshalAs(UnmanagedType.LPTStr)] </code><code class="csharp keyword">string</code> <code class="csharp plain">pOutput, </code><code class="csharp keyword">ref</code> <code class="csharp plain">structDevMode pDevMode);</code></div><div class="line number151 index150 alt2">&nbsp;</div><div class="line number152 index151 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"GDI32.dll"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"ResetDC"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">,</code></div><div class="line number153 index152 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">CharSet = CharSet.Unicode, ExactSpelling = </code><code class="csharp keyword">false</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number154 index153 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp plain">IntPtr ResetDC(IntPtr hDC, </code><code class="csharp keyword">ref</code> <code class="csharp plain">structDevMode pDevMode);</code></div><div class="line number155 index154 alt2">&nbsp;</div><div class="line number156 index155 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"GDI32.dll"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"DeleteDC"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Unicode, ExactSpelling = </code><code class="csharp keyword">false</code><code class="csharp plain">,</code></div><div class="line number157 index156 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number158 index157 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">DeleteDC(IntPtr hDC);</code></div><div class="line number159 index158 alt2">&nbsp;</div><div class="line number160 index159 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"SetPrinterA"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">,</code></div><div class="line number161 index160 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">CharSet = CharSet.Auto, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall), SuppressUnmanagedCodeSecurityAttribute()]</code></div><div class="line number162 index161 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">SetPrinter(IntPtr hPrinter, [MarshalAs(UnmanagedType.I4)] </code><code class="csharp keyword">int</code> <code class="csharp plain">level, IntPtr pPrinter, [MarshalAs(UnmanagedType.I4)] </code><code class="csharp keyword">int</code> <code class="csharp plain">command);</code></div><div class="line number163 index162 alt2">&nbsp;</div><div class="line number164 index163 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"DocumentPropertiesA"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number165 index164 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">int</code> <code class="csharp plain">DocumentProperties(IntPtr hwnd, IntPtr hPrinter, [MarshalAs(UnmanagedType.LPStr)] </code><code class="csharp keyword">string</code> <code class="csharp plain">pDeviceName, IntPtr pDevModeOutput, IntPtr pDevModeInput, </code><code class="csharp keyword">int</code> <code class="csharp plain">fMode);</code></div><div class="line number166 index165 alt1">&nbsp;</div><div class="line number167 index166 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"GetPrinterA"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number168 index167 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">GetPrinter(IntPtr hPrinter, </code><code class="csharp keyword">int</code> <code class="csharp plain">dwLevel, IntPtr pPrinter, </code><code class="csharp keyword">int</code> <code class="csharp plain">dwBuf, </code><code class="csharp keyword">out</code> <code class="csharp keyword">int</code> <code class="csharp plain">dwNeeded);</code></div><div class="line number169 index168 alt2">&nbsp;</div><div class="line number170 index169 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[Flags]</code></div><div class="line number171 index170 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">enum</code> <code class="csharp plain">SendMessageTimeoutFlags : </code><code class="csharp keyword">uint</code></div><div class="line number172 index171 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number173 index172 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SMTO_NORMAL = 0x0000,</code></div><div class="line number174 index173 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SMTO_BLOCK = 0x0001,</code></div><div class="line number175 index174 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SMTO_ABORTIFHUNG = 0x0002,</code></div><div class="line number176 index175 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SMTO_NOTIMEOUTIFNOTHUNG = 0x0008</code></div><div class="line number177 index176 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number178 index177 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">WM_SETTINGCHANGE = 0x001A;</code></div><div class="line number179 index178 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">HWND_BROADCAST = 0xffff;</code></div><div class="line number180 index179 alt1">&nbsp;</div><div class="line number181 index180 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"user32.dll"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Auto)]</code></div><div class="line number182 index181 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp plain">IntPtr SendMessageTimeout(IntPtr windowHandle, </code><code class="csharp keyword">uint</code> <code class="csharp plain">Msg, IntPtr wParam, IntPtr lParam, SendMessageTimeoutFlags flags, </code><code class="csharp keyword">uint</code> <code class="csharp plain">timeout, </code><code class="csharp keyword">out</code> <code class="csharp plain">IntPtr result);</code></div><div class="line number183 index182 alt2">&nbsp;</div><div class="line number184 index183 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//EnumPrinters用到的函数和结构体</code></div><div class="line number185 index184 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.drv"</code><code class="csharp plain">, CharSet = CharSet.Auto, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">)]</code></div><div class="line number186 index185 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">private</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">EnumPrinters(PrinterEnumFlags Flags, </code><code class="csharp keyword">string</code> <code class="csharp plain">Name, </code><code class="csharp keyword">uint</code> <code class="csharp plain">Level, IntPtr pPrinterEnum, </code><code class="csharp keyword">uint</code> <code class="csharp plain">cbBuf, </code><code class="csharp keyword">ref</code> <code class="csharp keyword">uint</code> <code class="csharp plain">pcbNeeded, </code><code class="csharp keyword">ref</code> <code class="csharp keyword">uint</code> <code class="csharp plain">pcReturned);</code></div><div class="line number187 index186 alt2">&nbsp;</div><div class="line number188 index187 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Sequential)]</code></div><div class="line number189 index188 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">struct</code> <code class="csharp plain">PRINTER_INFO_2</code></div><div class="line number190 index189 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number191 index190 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pServerName;</code></div><div class="line number192 index191 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pPrinterName;</code></div><div class="line number193 index192 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pShareName;</code></div><div class="line number194 index193 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pPortName;</code></div><div class="line number195 index194 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pDriverName;</code></div><div class="line number196 index195 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pComment;</code></div><div class="line number197 index196 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pLocation;</code></div><div class="line number198 index197 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">IntPtr pDevMode;</code></div><div class="line number199 index198 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pSepFile;</code></div><div class="line number200 index199 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pPrintProcessor;</code></div><div class="line number201 index200 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pDatatype;</code></div><div class="line number202 index201 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pParameters;</code></div><div class="line number203 index202 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">IntPtr pSecurityDescriptor;</code></div><div class="line number204 index203 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">Attributes;</code></div><div class="line number205 index204 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">Priority;</code></div><div class="line number206 index205 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">DefaultPriority;</code></div><div class="line number207 index206 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">StartTime;</code></div><div class="line number208 index207 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">UntilTime;</code></div><div class="line number209 index208 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">Status;</code></div><div class="line number210 index209 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">cJobs;</code></div><div class="line number211 index210 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">uint</code> <code class="csharp plain">AveragePPM;</code></div><div class="line number212 index211 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number213 index212 alt2">&nbsp;</div><div class="line number214 index213 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[FlagsAttribute]</code></div><div class="line number215 index214 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">enum</code> <code class="csharp plain">PrinterEnumFlags</code></div><div class="line number216 index215 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number217 index216 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_DEFAULT = 0x00000001,</code></div><div class="line number218 index217 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_LOCAL = 0x00000002,</code></div><div class="line number219 index218 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_CONNECTIONS = 0x00000004,</code></div><div class="line number220 index219 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_FAVORITE = 0x00000004,</code></div><div class="line number221 index220 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_NAME = 0x00000008,</code></div><div class="line number222 index221 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_REMOTE = 0x00000010,</code></div><div class="line number223 index222 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_SHARED = 0x00000020,</code></div><div class="line number224 index223 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_NETWORK = 0x00000040,</code></div><div class="line number225 index224 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_EXPAND = 0x00004000,</code></div><div class="line number226 index225 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_CONTAINER = 0x00008000,</code></div><div class="line number227 index226 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICONMASK = 0x00ff0000,</code></div><div class="line number228 index227 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON1 = 0x00010000,</code></div><div class="line number229 index228 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON2 = 0x00020000,</code></div><div class="line number230 index229 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON3 = 0x00040000,</code></div><div class="line number231 index230 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON4 = 0x00080000,</code></div><div class="line number232 index231 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON5 = 0x00100000,</code></div><div class="line number233 index232 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON6 = 0x00200000,</code></div><div class="line number234 index233 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON7 = 0x00400000,</code></div><div class="line number235 index234 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_ICON8 = 0x00800000,</code></div><div class="line number236 index235 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_ENUM_HIDE = 0x01000000</code></div><div class="line number237 index236 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number238 index237 alt1">&nbsp;</div><div class="line number239 index238 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//打印机状态</code></div><div class="line number240 index239 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[FlagsAttribute]</code></div><div class="line number241 index240 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">enum</code> <code class="csharp plain">PrinterStatus</code></div><div class="line number242 index241 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number243 index242 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_BUSY = 0x00000200,</code></div><div class="line number244 index243 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_DOOR_OPEN = 0x00400000,</code></div><div class="line number245 index244 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_ERROR = 0x00000002,</code></div><div class="line number246 index245 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_INITIALIZING = 0x00008000,</code></div><div class="line number247 index246 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_IO_ACTIVE = 0x00000100,</code></div><div class="line number248 index247 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_MANUAL_FEED = 0x00000020,</code></div><div class="line number249 index248 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_NO_TONER = 0x00040000,</code></div><div class="line number250 index249 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_NOT_AVAILABLE = 0x00001000,</code></div><div class="line number251 index250 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_OFFLINE = 0x00000080,</code></div><div class="line number252 index251 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_OUT_OF_MEMORY = 0x00200000,</code></div><div class="line number253 index252 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_OUTPUT_BIN_FULL = 0x00000800,</code></div><div class="line number254 index253 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PAGE_PUNT = 0x00080000,</code></div><div class="line number255 index254 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PAPER_JAM = 0x00000008,</code></div><div class="line number256 index255 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PAPER_OUT = 0x00000010,</code></div><div class="line number257 index256 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PAPER_PROBLEM = 0x00000040,</code></div><div class="line number258 index257 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PAUSED = 0x00000001,</code></div><div class="line number259 index258 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PENDING_DELETION = 0x00000004,</code></div><div class="line number260 index259 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PRINTING = 0x00000400,</code></div><div class="line number261 index260 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_PROCESSING = 0x00004000,</code></div><div class="line number262 index261 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_TONER_LOW = 0x00020000,</code></div><div class="line number263 index262 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_USER_INTERVENTION = 0x00100000,</code></div><div class="line number264 index263 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_WAITING = 0x20000000,</code></div><div class="line number265 index264 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_STATUS_WARMING_UP = 0x00010000</code></div><div class="line number266 index265 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number267 index266 alt2">&nbsp;</div><div class="line number268 index267 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//GetDefaultPrinter用到的API函数说明</code></div><div class="line number269 index268 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.drv"</code><code class="csharp plain">, CharSet = CharSet.Auto, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">)]</code></div><div class="line number270 index269 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">GetDefaultPrinter(StringBuilder pszBuffer, </code><code class="csharp keyword">ref</code> <code class="csharp keyword">int</code> <code class="csharp plain">size);</code></div><div class="line number271 index270 alt2">&nbsp;</div><div class="line number272 index271 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//SetDefaultPrinter用到的API函数声明</code></div><div class="line number273 index272 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.drv"</code><code class="csharp plain">, CharSet = CharSet.Auto, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">)]</code></div><div class="line number274 index273 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">SetDefaultPrinter(</code><code class="csharp keyword">string</code> <code class="csharp plain">Name);</code></div><div class="line number275 index274 alt2">&nbsp;</div><div class="line number276 index275 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//EnumFormsA用到的函数声明，应该和EnumPrinters类似</code></div><div class="line number277 index276 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"EnumForms"</code><code class="csharp plain">)]</code></div><div class="line number278 index277 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">int</code> <code class="csharp plain">EnumFormsA(IntPtr hPrinter, </code><code class="csharp keyword">int</code> <code class="csharp plain">Level, </code><code class="csharp keyword">ref</code> <code class="csharp keyword">byte</code> <code class="csharp plain">pForm, </code><code class="csharp keyword">int</code> <code class="csharp plain">cbBuf, </code><code class="csharp keyword">ref</code> <code class="csharp keyword">int</code> <code class="csharp plain">pcbNeeded, </code><code class="csharp keyword">ref</code> <code class="csharp keyword">int</code> <code class="csharp plain">pcReturned);</code></div><div class="line number279 index278 alt2">&nbsp;</div><div class="line number280 index279 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion&nbsp;&nbsp; API声明</code></div><div class="line number281 index280 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp keyword">int</code> <code class="csharp plain">GetPrinterStatusInt(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName)</code></div><div class="line number282 index281 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number283 index282 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">intRet = 0;</code></div><div class="line number284 index283 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr hPrinter;</code></div><div class="line number285 index284 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">structPrinterDefaults defaults = </code><code class="csharp keyword">new</code> <code class="csharp plain">structPrinterDefaults();</code></div><div class="line number286 index285 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(OpenPrinter(PrinterName, </code><code class="csharp keyword">out</code> <code class="csharp plain">hPrinter, </code><code class="csharp keyword">ref</code> <code class="csharp plain">defaults))</code></div><div class="line number287 index286 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number288 index287 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">cbNeeded = 0;</code></div><div class="line number289 index288 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">bolRet = GetPrinter(hPrinter, 2, IntPtr.Zero, 0, </code><code class="csharp keyword">out</code> <code class="csharp plain">cbNeeded);</code></div><div class="line number290 index289 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(cbNeeded &gt; 0)</code></div><div class="line number291 index290 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number292 index291 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr pAddr = Marshal.AllocHGlobal((</code><code class="csharp keyword">int</code><code class="csharp plain">)cbNeeded);</code></div><div class="line number293 index292 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bolRet = GetPrinter(hPrinter, 2, pAddr, cbNeeded, </code><code class="csharp keyword">out</code> <code class="csharp plain">cbNeeded);</code></div><div class="line number294 index293 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(bolRet)</code></div><div class="line number295 index294 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number296 index295 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_INFO_2 Info2 = </code><code class="csharp keyword">new</code> <code class="csharp plain">PRINTER_INFO_2();</code></div><div class="line number297 index296 alt2">&nbsp;</div><div class="line number298 index297 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2 = (PRINTER_INFO_2)Marshal.PtrToStructure(pAddr, </code><code class="csharp keyword">typeof</code><code class="csharp plain">(PRINTER_INFO_2));</code></div><div class="line number299 index298 alt2">&nbsp;</div><div class="line number300 index299 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">intRet = System.Convert.ToInt32(Info2.Status);</code></div><div class="line number301 index300 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number302 index301 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.FreeHGlobal(pAddr);</code></div><div class="line number303 index302 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number304 index303 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">ClosePrinter(hPrinter);</code></div><div class="line number305 index304 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number306 index305 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">intRet;</code></div><div class="line number307 index306 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number308 index307 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">internal</code> <code class="csharp keyword">static</code> <code class="csharp plain">PRINTER_INFO_2[] EnumPrintersByFlag(PrinterEnumFlags Flags)</code></div><div class="line number309 index308 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number310 index309 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">uint</code> <code class="csharp plain">cbNeeded = 0;</code></div><div class="line number311 index310 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">uint</code> <code class="csharp plain">cReturned = 0;</code></div><div class="line number312 index311 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">ret = EnumPrinters(PrinterEnumFlags.PRINTER_ENUM_LOCAL, </code><code class="csharp keyword">null</code><code class="csharp plain">, 2, IntPtr.Zero, 0, </code><code class="csharp keyword">ref</code> <code class="csharp plain">cbNeeded, </code><code class="csharp keyword">ref</code> <code class="csharp plain">cReturned);</code></div><div class="line number313 index312 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr pAddr = Marshal.AllocHGlobal((</code><code class="csharp keyword">int</code><code class="csharp plain">)cbNeeded);</code></div><div class="line number314 index313 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">ret = EnumPrinters(PrinterEnumFlags.PRINTER_ENUM_LOCAL, </code><code class="csharp keyword">null</code><code class="csharp plain">, 2, pAddr, cbNeeded, </code><code class="csharp keyword">ref</code> <code class="csharp plain">cbNeeded, </code><code class="csharp keyword">ref</code> <code class="csharp plain">cReturned);</code></div><div class="line number315 index314 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(ret)</code></div><div class="line number316 index315 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number317 index316 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_INFO_2[] Info2 = </code><code class="csharp keyword">new</code> <code class="csharp plain">PRINTER_INFO_2[cReturned];</code></div><div class="line number318 index317 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">offset = pAddr.ToInt32();</code></div><div class="line number319 index318 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">for</code> <code class="csharp plain">(</code><code class="csharp keyword">int</code> <code class="csharp plain">i = 0; i &lt; cReturned; i++)</code></div><div class="line number320 index319 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number321 index320 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pServerName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number322 index321 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number323 index322 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pPrinterName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number324 index323 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number325 index324 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pShareName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number326 index325 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number327 index326 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pPortName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number328 index327 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number329 index328 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pDriverName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number330 index329 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number331 index330 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pComment = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number332 index331 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number333 index332 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pLocation = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number334 index333 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number335 index334 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pDevMode = Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number336 index335 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number337 index336 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pSepFile = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number338 index337 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number339 index338 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pPrintProcessor = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number340 index339 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number341 index340 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pDatatype = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number342 index341 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number343 index342 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pParameters = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset)));</code></div><div class="line number344 index343 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number345 index344 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].pSecurityDescriptor = Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number346 index345 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number347 index346 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].Attributes = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadIntPtr(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number348 index347 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number349 index348 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].Priority = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadInt32(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number350 index349 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number351 index350 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].DefaultPriority = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadInt32(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number352 index351 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number353 index352 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].StartTime = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadInt32(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number354 index353 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number355 index354 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].UntilTime = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadInt32(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number356 index355 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number357 index356 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].Status = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadInt32(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number358 index357 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number359 index358 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].cJobs = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadInt32(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number360 index359 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number361 index360 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Info2[i].AveragePPM = (</code><code class="csharp keyword">uint</code><code class="csharp plain">)Marshal.ReadInt32(</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(offset));</code></div><div class="line number362 index361 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">offset += 4;</code></div><div class="line number363 index362 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number364 index363 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.FreeHGlobal(pAddr);</code></div><div class="line number365 index364 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">Info2;</code></div><div class="line number366 index365 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number367 index366 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">else</code></div><div class="line number368 index367 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number369 index368 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp keyword">new</code> <code class="csharp plain">PRINTER_INFO_2[0];</code></div><div class="line number370 index369 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number371 index370 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number372 index371 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 获取当前指定打印机的状态</code></div><div class="line number373 index372 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number374 index373 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 获取当前指定打印机的状态</code></div><div class="line number375 index374 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number376 index375 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="PrinterName"&gt;打印机名称&lt;/param&gt;</code></div><div class="line number377 index376 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;打印机状态描述&lt;/returns&gt;</code></div><div class="line number378 index377 alt1">&nbsp;</div><div class="line number379 index378 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">string</code> <code class="csharp plain">GetPrinterStatus(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName)</code></div><div class="line number380 index379 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number381 index380 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">intValue = GetPrinterStatusInt(PrinterName);</code></div><div class="line number382 index381 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">string</code> <code class="csharp plain">strRet = </code><code class="csharp keyword">string</code><code class="csharp plain">.Empty;</code></div><div class="line number383 index382 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">switch</code> <code class="csharp plain">(intValue)</code></div><div class="line number384 index383 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number385 index384 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0:</code></div><div class="line number386 index385 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"准备就绪（Ready）"</code><code class="csharp plain">;</code></div><div class="line number387 index386 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number388 index387 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000200:</code></div><div class="line number389 index388 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"忙(Busy）"</code><code class="csharp plain">;</code></div><div class="line number390 index389 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number391 index390 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00400000:</code></div><div class="line number392 index391 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"门被打开（Printer Door Open）"</code><code class="csharp plain">;</code></div><div class="line number393 index392 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number394 index393 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000002:</code></div><div class="line number395 index394 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"错误(Printer Error）"</code><code class="csharp plain">;</code></div><div class="line number396 index395 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number397 index396 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x0008000:</code></div><div class="line number398 index397 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"正在初始化(Initializing）"</code><code class="csharp plain">;</code></div><div class="line number399 index398 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number400 index399 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000100:</code></div><div class="line number401 index400 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"正在输入或输出（I/O Active）"</code><code class="csharp plain">;</code></div><div class="line number402 index401 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number403 index402 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000020:</code></div><div class="line number404 index403 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"手工送纸（Manual Feed）"</code><code class="csharp plain">;</code></div><div class="line number405 index404 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number406 index405 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00040000:</code></div><div class="line number407 index406 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"无墨粉（No Toner）"</code><code class="csharp plain">;</code></div><div class="line number408 index407 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number409 index408 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00001000:</code></div><div class="line number410 index409 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"不可用（Not Available）"</code><code class="csharp plain">;</code></div><div class="line number411 index410 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number412 index411 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000080:</code></div><div class="line number413 index412 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"脱机（Off Line）"</code><code class="csharp plain">;</code></div><div class="line number414 index413 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number415 index414 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00200000:</code></div><div class="line number416 index415 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"内存溢出（Out of Memory）"</code><code class="csharp plain">;</code></div><div class="line number417 index416 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number418 index417 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000800:</code></div><div class="line number419 index418 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"输出口已满（Output Bin Full）"</code><code class="csharp plain">;</code></div><div class="line number420 index419 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number421 index420 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00080000:</code></div><div class="line number422 index421 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"当前页无法打印（Page Punt）"</code><code class="csharp plain">;</code></div><div class="line number423 index422 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number424 index423 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000008:</code></div><div class="line number425 index424 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"塞纸（Paper Jam）"</code><code class="csharp plain">;</code></div><div class="line number426 index425 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number427 index426 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000010:</code></div><div class="line number428 index427 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"打印纸用完（Paper Out）"</code><code class="csharp plain">;</code></div><div class="line number429 index428 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number430 index429 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000040:</code></div><div class="line number431 index430 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"纸张问题（Page Problem）"</code><code class="csharp plain">;</code></div><div class="line number432 index431 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number433 index432 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000001:</code></div><div class="line number434 index433 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"暂停（Paused）"</code><code class="csharp plain">;</code></div><div class="line number435 index434 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number436 index435 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000004:</code></div><div class="line number437 index436 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"正在删除（Pending Deletion）"</code><code class="csharp plain">;</code></div><div class="line number438 index437 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number439 index438 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00000400:</code></div><div class="line number440 index439 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"正在打印（Printing）"</code><code class="csharp plain">;</code></div><div class="line number441 index440 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number442 index441 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00004000:</code></div><div class="line number443 index442 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"正在处理（Processing）"</code><code class="csharp plain">;</code></div><div class="line number444 index443 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number445 index444 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00020000:</code></div><div class="line number446 index445 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"墨粉不足（Toner Low）"</code><code class="csharp plain">;</code></div><div class="line number447 index446 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number448 index447 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00100000:</code></div><div class="line number449 index448 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"需要用户干预（User Intervention）"</code><code class="csharp plain">;</code></div><div class="line number450 index449 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number451 index450 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x20000000:</code></div><div class="line number452 index451 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"等待（Waiting）"</code><code class="csharp plain">;</code></div><div class="line number453 index452 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number454 index453 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">case</code> <code class="csharp plain">0x00010000:</code></div><div class="line number455 index454 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"正在准备（Warming Up）"</code><code class="csharp plain">;</code></div><div class="line number456 index455 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number457 index456 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">default</code><code class="csharp plain">:</code></div><div class="line number458 index457 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strRet = </code><code class="csharp string">"未知状态（Unknown Status）"</code><code class="csharp plain">;</code></div><div class="line number459 index458 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number460 index459 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number461 index460 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">strRet;</code></div><div class="line number462 index461 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number463 index462 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 获取当前指定打印机的状态</code></div><div class="line number464 index463 alt1">&nbsp;</div><div class="line number465 index464 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 删除已经存在的自定义纸张</code></div><div class="line number466 index465 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number467 index466 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number468 index467 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 删除已经存在的自定义纸张</code></div><div class="line number469 index468 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number470 index469 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="PrinterName"&gt;打印机名称&lt;/param&gt;</code></div><div class="line number471 index470 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="PaperName"&gt;纸张名称&lt;/param&gt;</code></div><div class="line number472 index471 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">void</code> <code class="csharp plain">DeleteCustomPaperSize(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName, </code><code class="csharp keyword">string</code> <code class="csharp plain">PaperName)</code></div><div class="line number473 index472 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number474 index473 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">PRINTER_ACCESS_USE = 0x00000008;</code></div><div class="line number475 index474 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">PRINTER_ACCESS_ADMINISTER = 0x00000004;</code></div><div class="line number476 index475 alt1">&nbsp;</div><div class="line number477 index476 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">structPrinterDefaults defaults = </code><code class="csharp keyword">new</code> <code class="csharp plain">structPrinterDefaults();</code></div><div class="line number478 index477 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">defaults.pDatatype = </code><code class="csharp keyword">null</code><code class="csharp plain">;</code></div><div class="line number479 index478 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">defaults.pDevMode = IntPtr.Zero;</code></div><div class="line number480 index479 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">defaults.DesiredAccess = PRINTER_ACCESS_ADMINISTER | PRINTER_ACCESS_USE;</code></div><div class="line number481 index480 alt2">&nbsp;</div><div class="line number482 index481 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr hPrinter = IntPtr.Zero;</code></div><div class="line number483 index482 alt2">&nbsp;</div><div class="line number484 index483 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//打开打印机</code></div><div class="line number485 index484 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(OpenPrinter(PrinterName, </code><code class="csharp keyword">out</code> <code class="csharp plain">hPrinter, </code><code class="csharp keyword">ref</code> <code class="csharp plain">defaults))</code></div><div class="line number486 index485 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number487 index486 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">try</code></div><div class="line number488 index487 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number489 index488 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">DeleteForm(hPrinter, PaperName);</code></div><div class="line number490 index489 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">ClosePrinter(hPrinter);</code></div><div class="line number491 index490 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number492 index491 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">catch</code></div><div class="line number493 index492 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number494 index493 alt1">&nbsp;</div><div class="line number495 index494 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number496 index495 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number497 index496 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number498 index497 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 删除已经存在的自定义纸张</code></div><div class="line number499 index498 alt2">&nbsp;</div><div class="line number500 index499 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 指定的打印机设置以mm为单位的自定义纸张(Form)</code></div><div class="line number501 index500 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number502 index501 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number503 index502 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 指定的打印机设置以mm为单位的自定义纸张(Form)</code></div><div class="line number504 index503 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number505 index504 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="PrinterName"&gt;打印机名称&lt;/param&gt;</code></div><div class="line number506 index505 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="PaperName"&gt;Form名称&lt;/param&gt;</code></div><div class="line number507 index506 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="WidthInMm"&gt;以mm为单位的宽度&lt;/param&gt;</code></div><div class="line number508 index507 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="HeightInMm"&gt;以mm为单位的高度&lt;/param&gt;</code></div><div class="line number509 index508 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">void</code> <code class="csharp plain">AddCustomPaperSize(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName, </code><code class="csharp keyword">string</code> <code class="csharp plain">PaperName, </code><code class="csharp keyword">float</code> <code class="csharp plain">WidthInMm, </code><code class="csharp keyword">float</code> <code class="csharp plain">HeightInMm)</code></div><div class="line number510 index509 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number511 index510 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(PlatformID.Win32NT == Environment.OSVersion.Platform)</code></div><div class="line number512 index511 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number513 index512 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">PRINTER_ACCESS_USE = 0x00000008;</code></div><div class="line number514 index513 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">PRINTER_ACCESS_ADMINISTER = 0x00000004;</code></div><div class="line number515 index514 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">structPrinterDefaults defaults = </code><code class="csharp keyword">new</code> <code class="csharp plain">structPrinterDefaults();</code></div><div class="line number516 index515 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">defaults.pDatatype = </code><code class="csharp keyword">null</code><code class="csharp plain">;</code></div><div class="line number517 index516 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">defaults.pDevMode = IntPtr.Zero;</code></div><div class="line number518 index517 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">defaults.DesiredAccess = PRINTER_ACCESS_ADMINISTER | PRINTER_ACCESS_USE;</code></div><div class="line number519 index518 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr hPrinter = IntPtr.Zero;</code></div><div class="line number520 index519 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//打开打印机</code></div><div class="line number521 index520 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(OpenPrinter(PrinterName, </code><code class="csharp keyword">out</code> <code class="csharp plain">hPrinter, </code><code class="csharp keyword">ref</code> <code class="csharp plain">defaults))</code></div><div class="line number522 index521 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number523 index522 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">try</code></div><div class="line number524 index523 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number525 index524 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//如果Form存在删除之</code></div><div class="line number526 index525 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">DeleteForm(hPrinter, PaperName);</code></div><div class="line number527 index526 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//创建并初始化FORM_INFO_1</code></div><div class="line number528 index527 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">FormInfo1 formInfo = </code><code class="csharp keyword">new</code> <code class="csharp plain">FormInfo1();</code></div><div class="line number529 index528 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.Flags = 0;</code></div><div class="line number530 index529 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.pName = PaperName;</code></div><div class="line number531 index530 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.Size.width = (</code><code class="csharp keyword">int</code><code class="csharp plain">)(WidthInMm * 1000.0);</code></div><div class="line number532 index531 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.Size.height = (</code><code class="csharp keyword">int</code><code class="csharp plain">)(HeightInMm * 1000.0);</code></div><div class="line number533 index532 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.ImageableArea.left = 0;</code></div><div class="line number534 index533 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.ImageableArea.right = formInfo.Size.width;</code></div><div class="line number535 index534 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.ImageableArea.top = 0;</code></div><div class="line number536 index535 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">formInfo.ImageableArea.bottom = formInfo.Size.height;</code></div><div class="line number537 index536 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(!AddForm(hPrinter, 1, </code><code class="csharp keyword">ref</code> <code class="csharp plain">formInfo))</code></div><div class="line number538 index537 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number539 index538 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">StringBuilder strBuilder = </code><code class="csharp keyword">new</code> <code class="csharp plain">StringBuilder();</code></div><div class="line number540 index539 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strBuilder.AppendFormat(</code><code class="csharp string">"向打印机 {1} 添加自定义纸张 {0} 失败！错误代号：{2}"</code><code class="csharp plain">,</code></div><div class="line number541 index540 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PaperName, PrinterName, GetLastError());</code></div><div class="line number542 index541 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">ApplicationException(strBuilder.ToString());</code></div><div class="line number543 index542 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number544 index543 alt1">&nbsp;</div><div class="line number545 index544 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//初始化</code></div><div class="line number546 index545 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">DM_OUT_BUFFER = 2;</code></div><div class="line number547 index546 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">int</code> <code class="csharp plain">DM_IN_BUFFER = 8;</code></div><div class="line number548 index547 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">structDevMode devMode = </code><code class="csharp keyword">new</code> <code class="csharp plain">structDevMode();</code></div><div class="line number549 index548 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr hPrinterInfo, hDummy;</code></div><div class="line number550 index549 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_INFO_9 printerInfo;</code></div><div class="line number551 index550 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">printerInfo.pDevMode = IntPtr.Zero;</code></div><div class="line number552 index551 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">iPrinterInfoSize, iDummyInt;</code></div><div class="line number553 index552 alt2">&nbsp;</div><div class="line number554 index553 alt1">&nbsp;</div><div class="line number555 index554 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">iDevModeSize = DocumentProperties(IntPtr.Zero, hPrinter, PrinterName, IntPtr.Zero, IntPtr.Zero, 0);</code></div><div class="line number556 index555 alt1">&nbsp;</div><div class="line number557 index556 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(iDevModeSize &lt; 0)</code></div><div class="line number558 index557 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">ApplicationException(</code><code class="csharp string">"无法取得DEVMODE结构的大小！"</code><code class="csharp plain">);</code></div><div class="line number559 index558 alt2">&nbsp;</div><div class="line number560 index559 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//分配缓冲</code></div><div class="line number561 index560 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr hDevMode = Marshal.AllocCoTaskMem(iDevModeSize + 100);</code></div><div class="line number562 index561 alt1">&nbsp;</div><div class="line number563 index562 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//获取DEV_MODE指针</code></div><div class="line number564 index563 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">iRet = DocumentProperties(IntPtr.Zero, hPrinter, PrinterName, hDevMode, IntPtr.Zero, DM_OUT_BUFFER);</code></div><div class="line number565 index564 alt2">&nbsp;</div><div class="line number566 index565 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(iRet &lt; 0)</code></div><div class="line number567 index566 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">ApplicationException(</code><code class="csharp string">"无法获得DEVMODE结构！"</code><code class="csharp plain">);</code></div><div class="line number568 index567 alt1">&nbsp;</div><div class="line number569 index568 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//填充DEV_MODE</code></div><div class="line number570 index569 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">devMode = (structDevMode)Marshal.PtrToStructure(hDevMode, devMode.GetType());</code></div><div class="line number571 index570 alt2">&nbsp;</div><div class="line number572 index571 alt1">&nbsp;</div><div class="line number573 index572 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">devMode.dmFields = 0x10000;</code></div><div class="line number574 index573 alt1">&nbsp;</div><div class="line number575 index574 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//FORM名称</code></div><div class="line number576 index575 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">devMode.dmFormName = PaperName;</code></div><div class="line number577 index576 alt2">&nbsp;</div><div class="line number578 index577 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.StructureToPtr(devMode, hDevMode, </code><code class="csharp keyword">true</code><code class="csharp plain">);</code></div><div class="line number579 index578 alt2">&nbsp;</div><div class="line number580 index579 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">iRet = DocumentProperties(IntPtr.Zero, hPrinter, PrinterName,</code></div><div class="line number581 index580 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">printerInfo.pDevMode, printerInfo.pDevMode, DM_IN_BUFFER | DM_OUT_BUFFER);</code></div><div class="line number582 index581 alt1">&nbsp;</div><div class="line number583 index582 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(iRet &lt; 0)</code></div><div class="line number584 index583 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">ApplicationException(</code><code class="csharp string">"无法为打印机设定打印方向！"</code><code class="csharp plain">);</code></div><div class="line number585 index584 alt2">&nbsp;</div><div class="line number586 index585 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">GetPrinter(hPrinter, 9, IntPtr.Zero, 0, </code><code class="csharp keyword">out</code> <code class="csharp plain">iPrinterInfoSize);</code></div><div class="line number587 index586 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(iPrinterInfoSize == 0)</code></div><div class="line number588 index587 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">ApplicationException(</code><code class="csharp string">"调用GetPrinter方法失败！"</code><code class="csharp plain">);</code></div><div class="line number589 index588 alt2">&nbsp;</div><div class="line number590 index589 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">hPrinterInfo = Marshal.AllocCoTaskMem(iPrinterInfoSize + 100);</code></div><div class="line number591 index590 alt2">&nbsp;</div><div class="line number592 index591 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">bSuccess = GetPrinter(hPrinter, 9, hPrinterInfo, iPrinterInfoSize, </code><code class="csharp keyword">out</code> <code class="csharp plain">iDummyInt);</code></div><div class="line number593 index592 alt2">&nbsp;</div><div class="line number594 index593 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(!bSuccess)</code></div><div class="line number595 index594 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">ApplicationException(</code><code class="csharp string">"调用GetPrinter方法失败！"</code><code class="csharp plain">);</code></div><div class="line number596 index595 alt1">&nbsp;</div><div class="line number597 index596 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">printerInfo = (PRINTER_INFO_9)Marshal.PtrToStructure(hPrinterInfo, printerInfo.GetType());</code></div><div class="line number598 index597 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">printerInfo.pDevMode = hDevMode;</code></div><div class="line number599 index598 alt2">&nbsp;</div><div class="line number600 index599 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.StructureToPtr(printerInfo, hPrinterInfo, </code><code class="csharp keyword">true</code><code class="csharp plain">);</code></div><div class="line number601 index600 alt2">&nbsp;</div><div class="line number602 index601 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bSuccess = SetPrinter(hPrinter, 9, hPrinterInfo, 0);</code></div><div class="line number603 index602 alt2">&nbsp;</div><div class="line number604 index603 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(!bSuccess)</code></div><div class="line number605 index604 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">Win32Exception(Marshal.GetLastWin32Error(), </code><code class="csharp string">"调用SetPrinter方法失败，无法进行打印机设置！"</code><code class="csharp plain">);</code></div><div class="line number606 index605 alt1">&nbsp;</div><div class="line number607 index606 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SendMessageTimeout(</code></div><div class="line number608 index607 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(HWND_BROADCAST),</code></div><div class="line number609 index608 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">WM_SETTINGCHANGE,</code></div><div class="line number610 index609 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr.Zero,</code></div><div class="line number611 index610 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr.Zero,</code></div><div class="line number612 index611 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PrinterHelper.SendMessageTimeoutFlags.SMTO_NORMAL,</code></div><div class="line number613 index612 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">1000,</code></div><div class="line number614 index613 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">out</code> <code class="csharp plain">hDummy);</code></div><div class="line number615 index614 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number616 index615 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">finally</code></div><div class="line number617 index616 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number618 index617 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">ClosePrinter(hPrinter);</code></div><div class="line number619 index618 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number620 index619 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number621 index620 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">else</code></div><div class="line number622 index621 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number623 index622 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">StringBuilder strBuilder = </code><code class="csharp keyword">new</code> <code class="csharp plain">StringBuilder();</code></div><div class="line number624 index623 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">strBuilder.AppendFormat(</code><code class="csharp string">"无法打开打印机{0}, 错误代号: {1}"</code><code class="csharp plain">,</code></div><div class="line number625 index624 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PrinterName, GetLastError());</code></div><div class="line number626 index625 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">throw</code> <code class="csharp keyword">new</code> <code class="csharp plain">ApplicationException(strBuilder.ToString());</code></div><div class="line number627 index626 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number628 index627 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number629 index628 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">else</code></div><div class="line number630 index629 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number631 index630 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">structDevMode pDevMode = </code><code class="csharp keyword">new</code> <code class="csharp plain">structDevMode();</code></div><div class="line number632 index631 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr hDC = CreateDC(</code><code class="csharp keyword">null</code><code class="csharp plain">, PrinterName, </code><code class="csharp keyword">null</code><code class="csharp plain">, </code><code class="csharp keyword">ref</code> <code class="csharp plain">pDevMode);</code></div><div class="line number633 index632 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(hDC != IntPtr.Zero)</code></div><div class="line number634 index633 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number635 index634 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">long</code> <code class="csharp plain">DM_PAPERSIZE = 0x00000002L;</code></div><div class="line number636 index635 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">long</code> <code class="csharp plain">DM_PAPERLENGTH = 0x00000004L;</code></div><div class="line number637 index636 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">const</code> <code class="csharp keyword">long</code> <code class="csharp plain">DM_PAPERWIDTH = 0x00000008L;</code></div><div class="line number638 index637 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pDevMode.dmFields = (</code><code class="csharp keyword">int</code><code class="csharp plain">)(DM_PAPERSIZE | DM_PAPERWIDTH | DM_PAPERLENGTH);</code></div><div class="line number639 index638 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pDevMode.dmPaperSize = 256;</code></div><div class="line number640 index639 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pDevMode.dmPaperWidth = (</code><code class="csharp keyword">short</code><code class="csharp plain">)(WidthInMm * 1000.0);</code></div><div class="line number641 index640 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pDevMode.dmPaperLength = (</code><code class="csharp keyword">short</code><code class="csharp plain">)(HeightInMm * 1000.0);</code></div><div class="line number642 index641 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">ResetDC(hDC, </code><code class="csharp keyword">ref</code> <code class="csharp plain">pDevMode);</code></div><div class="line number643 index642 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">DeleteDC(hDC);</code></div><div class="line number644 index643 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number645 index644 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number646 index645 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number647 index646 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 指定的打印机设置以mm为单位的自定义纸张(Form)</code></div><div class="line number648 index647 alt1">&nbsp;</div><div class="line number649 index648 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 获取本地打印机列表</code></div><div class="line number650 index649 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number651 index650 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number652 index651 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 获取本地打印机列表</code></div><div class="line number653 index652 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 可以通过制定参数获取网络打印机</code></div><div class="line number654 index653 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number655 index654 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;打印机列表&lt;/returns&gt;</code></div><div class="line number656 index655 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp plain">System.Collections.ArrayList GetPrinterList()</code></div><div class="line number657 index656 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number658 index657 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">System.Collections.ArrayList alRet = </code><code class="csharp keyword">new</code> <code class="csharp plain">System.Collections.ArrayList();</code></div><div class="line number659 index658 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">PRINTER_INFO_2[] Info2 = EnumPrintersByFlag(PrinterEnumFlags.PRINTER_ENUM_LOCAL);</code></div><div class="line number660 index659 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">for</code> <code class="csharp plain">(</code><code class="csharp keyword">int</code> <code class="csharp plain">i = 0; i &lt; Info2.Length; i++)</code></div><div class="line number661 index660 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number662 index661 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">alRet.Add(Info2[i].pPrinterName);</code></div><div class="line number663 index662 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number664 index663 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">alRet;</code></div><div class="line number665 index664 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number666 index665 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 获取本地打印机列表</code></div><div class="line number667 index666 alt2">&nbsp;</div><div class="line number668 index667 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 获取本机的默认打印机名称</code></div><div class="line number669 index668 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number670 index669 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number671 index670 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 获取本机的默认打印机名称</code></div><div class="line number672 index671 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number673 index672 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;默认打印机名称&lt;/returns&gt;</code></div><div class="line number674 index673 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">string</code> <code class="csharp plain">GetDeaultPrinterName()</code></div><div class="line number675 index674 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number676 index675 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">StringBuilder dp = </code><code class="csharp keyword">new</code> <code class="csharp plain">StringBuilder(256);</code></div><div class="line number677 index676 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">size = dp.Capacity;</code></div><div class="line number678 index677 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(GetDefaultPrinter(dp, </code><code class="csharp keyword">ref</code> <code class="csharp plain">size))</code></div><div class="line number679 index678 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number680 index679 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">dp.ToString();</code></div><div class="line number681 index680 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number682 index681 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">else</code></div><div class="line number683 index682 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number684 index683 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp keyword">string</code><code class="csharp plain">.Empty;</code></div><div class="line number685 index684 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number686 index685 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number687 index686 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 获取本机的默认打印机名称</code></div><div class="line number688 index687 alt1">&nbsp;</div><div class="line number689 index688 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 设置默认打印机</code></div><div class="line number690 index689 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number691 index690 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number692 index691 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 设置默认打印机</code></div><div class="line number693 index692 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number694 index693 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="PrinterName"&gt;可用的打印机名称&lt;/param&gt;</code></div><div class="line number695 index694 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">void</code> <code class="csharp plain">SetPrinterToDefault(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName)</code></div><div class="line number696 index695 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number697 index696 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SetDefaultPrinter(PrinterName);</code></div><div class="line number698 index697 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number699 index698 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 设置默认打印机</code></div><div class="line number700 index699 alt1">&nbsp;</div><div class="line number701 index700 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 判断打印机是否在系统可用的打印机列表中</code></div><div class="line number702 index701 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number703 index702 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;summary&gt;</code></div><div class="line number704 index703 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// 判断打印机是否在系统可用的打印机列表中</code></div><div class="line number705 index704 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;/summary&gt;</code></div><div class="line number706 index705 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;param name="PrinterName"&gt;打印机名称&lt;/param&gt;</code></div><div class="line number707 index706 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;returns&gt;是：在；否：不在&lt;/returns&gt;</code></div><div class="line number708 index707 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">bool</code> <code class="csharp plain">PrinterInList(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName)</code></div><div class="line number709 index708 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number710 index709 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">bolRet = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number711 index710 alt2">&nbsp;</div><div class="line number712 index711 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">System.Collections.ArrayList alPrinters = GetPrinterList();</code></div><div class="line number713 index712 alt2">&nbsp;</div><div class="line number714 index713 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">for</code> <code class="csharp plain">(</code><code class="csharp keyword">int</code> <code class="csharp plain">i = 0; i &lt; alPrinters.Count; i++)</code></div><div class="line number715 index714 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number716 index715 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(PrinterName == alPrinters[i].ToString())</code></div><div class="line number717 index716 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number718 index717 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bolRet = </code><code class="csharp keyword">true</code><code class="csharp plain">;</code></div><div class="line number719 index718 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number720 index719 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number721 index720 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number722 index721 alt1">&nbsp;</div><div class="line number723 index722 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">alPrinters.Clear();</code></div><div class="line number724 index723 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">alPrinters = </code><code class="csharp keyword">null</code><code class="csharp plain">;</code></div><div class="line number725 index724 alt2">&nbsp;</div><div class="line number726 index725 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">bolRet;</code></div><div class="line number727 index726 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number728 index727 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 判断打印机是否在系统可用的打印机列表中</code></div><div class="line number729 index728 alt2">&nbsp;</div><div class="line number730 index729 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 判断表单是否在指定的打印机所支持的纸张列表中</code></div><div class="line number731 index730 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number732 index731 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;summary&gt;</code></div><div class="line number733 index732 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// 判断表单是否在指定的打印机所支持的纸张列表中,表单就是我们平常所说的纸张</code></div><div class="line number734 index733 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;/summary&gt;</code></div><div class="line number735 index734 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;param name="PrinterName"&gt;打印机名称&lt;/param&gt;</code></div><div class="line number736 index735 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;param name="PaperName"&gt;纸张名称&lt;/param&gt;</code></div><div class="line number737 index736 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///// &lt;returns&gt;是：在；否：不在&lt;/returns&gt;</code></div><div class="line number738 index737 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">bool</code> <code class="csharp plain">FormInPrinter(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName, </code><code class="csharp keyword">string</code> <code class="csharp plain">PaperName)</code></div><div class="line number739 index738 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number740 index739 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">bolRet = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number741 index740 alt2">&nbsp;</div><div class="line number742 index741 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">System.Drawing.Printing.PrintDocument pd = </code><code class="csharp keyword">new</code> <code class="csharp plain">System.Drawing.Printing.PrintDocument();</code></div><div class="line number743 index742 alt2">&nbsp;</div><div class="line number744 index743 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pd.PrinterSettings.PrinterName = PrinterName;</code></div><div class="line number745 index744 alt2">&nbsp;</div><div class="line number746 index745 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">foreach</code> <code class="csharp plain">(System.Drawing.Printing.PaperSize ps </code><code class="csharp keyword">in</code> <code class="csharp plain">pd.PrinterSettings.PaperSizes)</code></div><div class="line number747 index746 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number748 index747 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(ps.PaperName == PaperName)</code></div><div class="line number749 index748 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number750 index749 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bolRet = </code><code class="csharp keyword">true</code><code class="csharp plain">;</code></div><div class="line number751 index750 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number752 index751 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number753 index752 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number754 index753 alt1">&nbsp;</div><div class="line number755 index754 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pd.Dispose();</code></div><div class="line number756 index755 alt1">&nbsp;</div><div class="line number757 index756 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">bolRet;</code></div><div class="line number758 index757 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number759 index758 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 判断表单是否在指定的打印机所支持的纸张列表中</code></div><div class="line number760 index759 alt1">&nbsp;</div><div class="line number761 index760 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 判断指定纸张的宽度和高度和与打印内容指定的宽度和高度是否匹配</code></div><div class="line number762 index761 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number763 index762 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number764 index763 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 判断指定纸张的宽度和高度和与打印内容指定的宽度和高度是否匹配</code></div><div class="line number765 index764 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number766 index765 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="PrinterName"&gt;打印机名称&lt;/param&gt;</code></div><div class="line number767 index766 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="FormName"&gt;表单名称&lt;/param&gt;</code></div><div class="line number768 index767 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="Width"&gt;宽度&lt;/param&gt;</code></div><div class="line number769 index768 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="Height"&gt;高度&lt;/param&gt;</code></div><div class="line number770 index769 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;&lt;/returns&gt;</code></div><div class="line number771 index770 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">bool</code> <code class="csharp plain">FormSameSize(</code><code class="csharp keyword">string</code> <code class="csharp plain">PrinterName, </code><code class="csharp keyword">string</code> <code class="csharp plain">FormName, </code><code class="csharp keyword">decimal</code> <code class="csharp plain">Width, </code><code class="csharp keyword">decimal</code> <code class="csharp plain">Height)</code></div><div class="line number772 index771 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number773 index772 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">bolRet = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number774 index773 alt1">&nbsp;</div><div class="line number775 index774 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">System.Drawing.Printing.PrintDocument pd = </code><code class="csharp keyword">new</code> <code class="csharp plain">System.Drawing.Printing.PrintDocument();</code></div><div class="line number776 index775 alt1">&nbsp;</div><div class="line number777 index776 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pd.PrinterSettings.PrinterName = PrinterName;</code></div><div class="line number778 index777 alt1">&nbsp;</div><div class="line number779 index778 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">foreach</code> <code class="csharp plain">(System.Drawing.Printing.PaperSize ps </code><code class="csharp keyword">in</code> <code class="csharp plain">pd.PrinterSettings.PaperSizes)</code></div><div class="line number780 index779 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number781 index780 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(ps.PaperName == FormName)</code></div><div class="line number782 index781 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number783 index782 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">decimal</code> <code class="csharp plain">decWidth = FromInchToCM(System.Convert.ToDecimal(ps.Width));</code></div><div class="line number784 index783 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">decimal</code> <code class="csharp plain">decHeight = FromInchToCM(System.Convert.ToDecimal(ps.Height));</code></div><div class="line number785 index784 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//只要整数位相同即认为是同一纸张，毕竟inch到cm的转换并不能整除</code></div><div class="line number786 index785 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(Math.Round(decWidth, 0) == Math.Round(Width, 0) &amp;&amp; Math.Round(decHeight, 0) == Math.Round(Height, 0))</code></div><div class="line number787 index786 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bolRet = </code><code class="csharp keyword">true</code><code class="csharp plain">;</code></div><div class="line number788 index787 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">break</code><code class="csharp plain">;</code></div><div class="line number789 index788 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number790 index789 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number791 index790 alt2">&nbsp;</div><div class="line number792 index791 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pd.Dispose();</code></div><div class="line number793 index792 alt2">&nbsp;</div><div class="line number794 index793 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">bolRet;</code></div><div class="line number795 index794 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number796 index795 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 判断指定纸张的宽度和高度和与打印内容指定的宽度和高度是否匹配</code></div><div class="line number797 index796 alt2">&nbsp;</div><div class="line number798 index797 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 英寸到厘米的转换</code></div><div class="line number799 index798 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/**/</code></div><div class="line number800 index799 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number801 index800 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 英寸到厘米的转换</code></div><div class="line number802 index801 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// /* = = = = = = = = = = = = = = = = *\</code></div><div class="line number803 index802 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// | 换算一下计量单位，将其换算成厘米&nbsp; |</code></div><div class="line number804 index803 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// |&nbsp;&nbsp;&nbsp; 厘米&nbsp;&nbsp;&nbsp;&nbsp; 像素&nbsp;&nbsp;&nbsp;&nbsp; 英寸&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number805 index804 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// |&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 38&nbsp;&nbsp;&nbsp;&nbsp; 0.395&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number806 index805 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// |&nbsp;&nbsp; 0.026&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number807 index806 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// |&nbsp;&nbsp;&nbsp; 2.54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number808 index807 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// \* = = = = = = = = = = = = = = = = */</code></div><div class="line number809 index808 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number810 index809 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="inch"&gt;英寸数&lt;/param&gt;</code></div><div class="line number811 index810 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;厘米数，两位小数&lt;/returns&gt;</code></div><div class="line number812 index811 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">///</code></div><div class="line number813 index812 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">decimal</code> <code class="csharp plain">FromInchToCM(</code><code class="csharp keyword">decimal</code> <code class="csharp plain">inch)</code></div><div class="line number814 index813 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number815 index814 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">Math.Round((System.Convert.ToDecimal((inch / 100)) * System.Convert.ToDecimal(2.5400)), 2);</code></div><div class="line number816 index815 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number817 index816 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion 英寸到厘米的转换</code></div><div class="line number818 index817 alt1">&nbsp;</div><div class="line number819 index818 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#region 打印操作</code></div><div class="line number820 index819 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"OpenPrinterA"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Ansi, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number821 index820 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">OpenPrinter([MarshalAs(UnmanagedType.LPStr)] </code><code class="csharp keyword">string</code> <code class="csharp plain">szPrinter, </code><code class="csharp keyword">out</code> <code class="csharp plain">IntPtr hPrinter, IntPtr pd);</code></div><div class="line number822 index821 alt1">&nbsp;</div><div class="line number823 index822 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"StartDocPrinterA"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, CharSet = CharSet.Ansi, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number824 index823 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">StartDocPrinter(IntPtr hPrinter, Int32 level, [In, MarshalAs(UnmanagedType.LPStruct)] DOCINFOA di);</code></div><div class="line number825 index824 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"EndDocPrinter"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number826 index825 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">EndDocPrinter(IntPtr hPrinter);</code></div><div class="line number827 index826 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"StartPagePrinter"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number828 index827 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">StartPagePrinter(IntPtr hPrinter);</code></div><div class="line number829 index828 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"EndPagePrinter"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number830 index829 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">EndPagePrinter(IntPtr hPrinter);</code></div><div class="line number831 index830 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[DllImport(</code><code class="csharp string">"winspool.Drv"</code><code class="csharp plain">, EntryPoint = </code><code class="csharp string">"WritePrinter"</code><code class="csharp plain">, SetLastError = </code><code class="csharp keyword">true</code><code class="csharp plain">, ExactSpelling = </code><code class="csharp keyword">true</code><code class="csharp plain">, CallingConvention = CallingConvention.StdCall)]</code></div><div class="line number832 index831 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">extern</code> <code class="csharp keyword">bool</code> <code class="csharp plain">WritePrinter(IntPtr hPrinter, IntPtr pBytes, Int32 dwCount, </code><code class="csharp keyword">out</code> <code class="csharp plain">Int32 dwWritten);</code></div><div class="line number833 index832 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number834 index833 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 该方法把非托管内存中的字节数组发送到打印机的打印队列&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number835 index834 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number836 index835 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="szPrinterName"&gt;打印机名称&lt;/param&gt;</code></div><div class="line number837 index836 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="pBytes"&gt;非托管内存指针&lt;/param&gt;</code></div><div class="line number838 index837 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="dwCount"&gt;字节数&lt;/param&gt;</code></div><div class="line number839 index838 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;成功返回true，失败时为false&lt;/returns&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number840 index839 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">bool</code> <code class="csharp plain">SendBytesToPrinter(</code><code class="csharp keyword">string</code> <code class="csharp plain">szPrinterName, IntPtr pBytes, Int32 dwCount)</code></div><div class="line number841 index840 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number842 index841 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Int32 dwError = 0, dwWritten = 0;</code></div><div class="line number843 index842 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr hPrinter = </code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(0);</code></div><div class="line number844 index843 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">DOCINFOA di = </code><code class="csharp keyword">new</code> <code class="csharp plain">DOCINFOA();</code></div><div class="line number845 index844 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">bSuccess = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number846 index845 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">di.pDocName = </code><code class="csharp string">"My C#.NET RAW Document"</code><code class="csharp plain">;</code></div><div class="line number847 index846 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">di.pDataType = </code><code class="csharp string">"RAW"</code><code class="csharp plain">;</code></div><div class="line number848 index847 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">try</code></div><div class="line number849 index848 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number850 index849 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 打开打印机&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number851 index850 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(OpenPrinter(szPrinterName.Normalize(), </code><code class="csharp keyword">out</code> <code class="csharp plain">hPrinter, IntPtr.Zero))</code></div><div class="line number852 index851 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number853 index852 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 启动文档打印&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number854 index853 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(StartDocPrinter(hPrinter, 1, di))</code></div><div class="line number855 index854 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number856 index855 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 开始打印&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number857 index856 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(StartPagePrinter(hPrinter))</code></div><div class="line number858 index857 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number859 index858 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 向打印机输出字节&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number860 index859 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bSuccess = WritePrinter(hPrinter, pBytes, dwCount, </code><code class="csharp keyword">out</code> <code class="csharp plain">dwWritten);</code></div><div class="line number861 index860 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">EndPagePrinter(hPrinter);</code></div><div class="line number862 index861 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number863 index862 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">EndDocPrinter(hPrinter);</code></div><div class="line number864 index863 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number865 index864 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">ClosePrinter(hPrinter);</code></div><div class="line number866 index865 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number867 index866 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(bSuccess == </code><code class="csharp keyword">false</code><code class="csharp plain">)</code></div><div class="line number868 index867 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number869 index868 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">dwError = Marshal.GetLastWin32Error();</code></div><div class="line number870 index869 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number871 index870 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number872 index871 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">catch</code> <code class="csharp plain">(Win32Exception ex)</code></div><div class="line number873 index872 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number874 index873 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bSuccess = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number875 index874 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number876 index875 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">bSuccess;</code></div><div class="line number877 index876 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number878 index877 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number879 index878 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 发送文件到打印机方法&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number880 index879 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number881 index880 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="szPrinterName"&gt;打印机名称&lt;/param&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number882 index881 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="szFileName"&gt;打印文件的路径&lt;/param&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number883 index882 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;&lt;/returns&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number884 index883 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">bool</code> <code class="csharp plain">SendFileToPrinter(</code><code class="csharp keyword">string</code> <code class="csharp plain">szPrinterName, </code><code class="csharp keyword">string</code> <code class="csharp plain">szFileName)</code></div><div class="line number885 index884 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number886 index885 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">bSuccess = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number887 index886 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">try</code></div><div class="line number888 index887 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number889 index888 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 打开文件&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number890 index889 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">FileStream fs = </code><code class="csharp keyword">new</code> <code class="csharp plain">FileStream(szFileName, FileMode.Open);</code></div><div class="line number891 index890 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 将文件内容读作二进制&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number892 index891 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">BinaryReader br = </code><code class="csharp keyword">new</code> <code class="csharp plain">BinaryReader(fs);</code></div><div class="line number893 index892 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 定义字节数组&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number894 index893 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Byte[] bytes = </code><code class="csharp keyword">new</code> <code class="csharp plain">Byte[fs.Length];</code></div><div class="line number895 index894 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 非托管指针&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number896 index895 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr pUnmanagedBytes = </code><code class="csharp keyword">new</code> <code class="csharp plain">IntPtr(0);</code></div><div class="line number897 index896 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">int</code> <code class="csharp plain">nLength;</code></div><div class="line number898 index897 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">nLength = Convert.ToInt32(fs.Length);</code></div><div class="line number899 index898 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 读取文件内容到字节数组&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number900 index899 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bytes = br.ReadBytes(nLength);</code></div><div class="line number901 index900 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 为这些字节分配一些非托管内存&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number902 index901 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">pUnmanagedBytes = Marshal.AllocCoTaskMem(nLength);</code></div><div class="line number903 index902 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 将托管字节数组复制到非托管内存指针&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number904 index903 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.Copy(bytes, 0, pUnmanagedBytes, nLength);</code></div><div class="line number905 index904 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 将非托管字节发送到打印机&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number906 index905 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bSuccess = SendBytesToPrinter(szPrinterName, pUnmanagedBytes, nLength);</code></div><div class="line number907 index906 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 释放先前分配的非托管内存&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number908 index907 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.FreeCoTaskMem(pUnmanagedBytes);</code></div><div class="line number909 index908 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">fs.Close();</code></div><div class="line number910 index909 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">fs.Dispose();</code></div><div class="line number911 index910 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number912 index911 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">catch</code> <code class="csharp plain">(Win32Exception ex)</code></div><div class="line number913 index912 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number914 index913 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">bSuccess = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number915 index914 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number916 index915 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">bSuccess;</code></div><div class="line number917 index916 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number918 index917 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;&nbsp; </code></div><div class="line number919 index918 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 将字符串发送到打印机方法&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number920 index919 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">/*</code></div><div class="line number921 index920 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//打印示例：</code></div><div class="line number922 index921 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">StringBuilder builder = new StringBuilder();</code></div><div class="line number923 index922 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">builder.AppendLine("--------------打印测试--------------");</code></div><div class="line number924 index923 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">string PrintName = PrinterHelper.GetDeaultPrinterName();</code></div><div class="line number925 index924 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">PrinterHelper.SendStringToPrinter(PrintName, builder.ToString());</code></div><div class="line number926 index925 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">*/</code></div><div class="line number927 index926 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number928 index927 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="szPrinterName"&gt;打印机名称&lt;/param&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number929 index928 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;param name="szString"&gt;打印的字符串&lt;/param&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number930 index929 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;returns&gt;&lt;/returns&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number931 index930 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">bool</code> <code class="csharp plain">SendStringToPrinter(</code><code class="csharp keyword">string</code> <code class="csharp plain">szPrinterName, </code><code class="csharp keyword">string</code> <code class="csharp plain">szString)</code></div><div class="line number932 index931 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number933 index932 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">bool</code> <code class="csharp plain">flag = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number934 index933 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">try</code></div><div class="line number935 index934 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number936 index935 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 读取文件内容到字节数组</code></div><div class="line number937 index936 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">byte</code><code class="csharp plain">[] bytes = Encoding.GetEncoding(</code><code class="csharp string">"GB2312"</code><code class="csharp plain">).GetBytes(szString.ToString());</code></div><div class="line number938 index937 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Int32 dwCount = bytes.Length;</code></div><div class="line number939 index938 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 非托管指针&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number940 index939 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr pBytes = Marshal.AllocHGlobal(dwCount);</code></div><div class="line number941 index940 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 将托管字节数组复制到非托管内存指针&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number942 index941 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.Copy(bytes, 0, pBytes, dwCount);</code></div><div class="line number943 index942 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 将非托管字节发送到打印机&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number944 index943 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">flag = SendBytesToPrinter(szPrinterName, pBytes, dwCount);</code></div><div class="line number945 index944 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">if</code> <code class="csharp plain">(flag)</code></div><div class="line number946 index945 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number947 index946 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">StartQianXiang(szPrinterName);&nbsp; </code><code class="csharp comments">//开钱箱操作</code></div><div class="line number948 index947 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number949 index948 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">// 释放先前分配的非托管内存&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number950 index949 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.FreeCoTaskMem(pBytes);</code></div><div class="line number951 index950 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number952 index951 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">catch</code> <code class="csharp plain">(Win32Exception ex)</code></div><div class="line number953 index952 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number954 index953 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">flag = </code><code class="csharp keyword">false</code><code class="csharp plain">;</code></div><div class="line number955 index954 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number956 index955 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp plain">flag;</code></div><div class="line number957 index956 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number958 index957 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;summary&gt;</code></div><div class="line number959 index958 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// 开始弹出钱箱</code></div><div class="line number960 index959 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp color1">/// &lt;/summary&gt;</code></div><div class="line number961 index960 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">static</code> <code class="csharp keyword">void</code> <code class="csharp plain">StartQianXiang(</code><code class="csharp keyword">string</code> <code class="csharp plain">szPrinterName)</code></div><div class="line number962 index961 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number963 index962 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp comments">//不同的打印机需要不同的参数，这个参数应该可以在打印机的编程文档中找到</code></div><div class="line number964 index963 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">string</code> <code class="csharp plain">str = ((</code><code class="csharp keyword">char</code><code class="csharp plain">)27).ToString() + ((</code><code class="csharp keyword">char</code><code class="csharp plain">)112).ToString() + ((</code><code class="csharp keyword">char</code><code class="csharp plain">)0).ToString() + ((</code><code class="csharp keyword">char</code><code class="csharp plain">)0).ToString() + ((</code><code class="csharp keyword">char</code><code class="csharp plain">)0).ToString();</code></div><div class="line number965 index964 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">byte</code><code class="csharp plain">[] bytes = System.Text.Encoding.Default.GetBytes(str);</code></div><div class="line number966 index965 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Int32 dwCount = bytes.Length;</code></div><div class="line number967 index966 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">IntPtr pBytes = Marshal.AllocHGlobal(dwCount);</code></div><div class="line number968 index967 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.Copy(bytes, 0, pBytes, dwCount);</code></div><div class="line number969 index968 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">SendBytesToPrinter(szPrinterName, pBytes, dwCount);</code></div><div class="line number970 index969 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Marshal.FreeCoTaskMem(pBytes);</code></div><div class="line number971 index970 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number972 index971 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number973 index972 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number974 index973 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]</code></div><div class="line number975 index974 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">class</code> <code class="csharp plain">DOCINFOA</code></div><div class="line number976 index975 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number977 index976 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.LPStr)]</code></div><div class="line number978 index977 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pDocName;</code></div><div class="line number979 index978 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.LPStr)]</code></div><div class="line number980 index979 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pOutputFile;</code></div><div class="line number981 index980 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">[MarshalAs(UnmanagedType.LPStr)]</code></div><div class="line number982 index981 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">string</code> <code class="csharp plain">pDataType;</code></div><div class="line number983 index982 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number984 index983 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp preprocessor">#endregion</code></div><div class="line number985 index984 alt2"><code class="csharp plain">}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>&nbsp;</p>
<hr>
<p>&nbsp;</p>
</div>
<div id="MySignature" role="contentinfo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    "唯有高屋建瓴，方可水到渠成"
</font></font></div>
<div class="clear"></div>
<div id="blog_post_info_block" role="contentinfo"><div id="BlogPostCategory"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    分類: 
             </font></font><a href="https://www.cnblogs.com/sntetwt/category/287329.html" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asp.net</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,              </font></font><a href="https://www.cnblogs.com/sntetwt/category/703234.html" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C#</font></font></a></div>


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(9730408,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好文要頂</font></font></a>
        <a id="green_channel_follow" onclick="follow(&#39;51ed2195-d1e8-df11-ac81-842b2b196315&#39;);" href="javascript:void(0);"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">關注我</font></font></a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收藏該文</font></font></a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/sntetwt/" target="_blank"><img src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/20130314155919.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/sntetwt/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">microsoftzhcn</font></font></a><br>
            <a href="https://home.cnblogs.com/u/sntetwt/followers/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">粉絲- </font></font><span class="follower-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></span></a>
            <a href="https://home.cnblogs.com/u/sntetwt/followees/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">關注- </font></font><span class="following-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></a><br>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow" class="follow-tip">
                <a href="javascript:void(0);" onclick="follow(&#39;51ed2195-d1e8-df11-ac81-842b2b196315&#39;);return false;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+加關注</font></font></a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(9730408,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span>
    </div>
    <div class="buryit" onclick="votePost(9730408,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>

<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/sntetwt/p/9686156.html" class="p_n_p_prefix"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一篇：     </font></font><a href="https://www.cnblogs.com/sntetwt/p/9686156.html" data-featured-image="" title="發佈於2018-09-21 13:47"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WPF 實現陰影效果</font></font></a>
    <br>
    <a href="https://www.cnblogs.com/sntetwt/p/9771133.html" class="p_n_p_prefix"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一篇：     </font></font><a href="https://www.cnblogs.com/sntetwt/p/9771133.html" data-featured-image="" title="發佈於2018-10-11 10:42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WPF 控件之Popup</font></font></a>

</div>
</div>
            </div>
            <div class="postDesc">posted @ 
<span id="post-date">2018-09-30 15:55</span>&nbsp;
<a href="https://www.cnblogs.com/sntetwt/">microsoftzhcn</a>&nbsp;
阅读(<span id="post_view_count">1123</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=9730408" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(9730408);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: &#39;&#39;, targetType: &#39;blogPost&#39;, targetId: &#39;9730408&#39;, targetLink: &#39;https://www.cnblogs.com/sntetwt/p/9730408.html&#39;, title: &#39;C#调用系统打印机和收银钱箱&#39; })">举报</a></div>
        </div>
	    
	    
    </div><!--end: topics 文章、评论容器-->
</div>

<script>
    var cb_entryId = 9730408, cb_entryCreatedDate = '2018-09-30 15:55', cb_postType = 1, cb_postTitle = 'C#调用系统打印机和收银钱箱';
    var allowComments = true, cb_blogId = 84861, cb_blogApp = 'sntetwt', cb_blogUserGuid = '51ed2195-d1e8-df11-ac81-842b2b196315';
    mermaidRender.render()
    markdown_highlight()
    zoomManager.apply("#cnblogs_post_body img:not(.code_img_closed):not(.code_img_opened)");
    updatePostStats(
            [cb_entryId],
            function(id, count) { $("#post_view_count").text(count) },
            function(id, count) { $("#post_comment_count").text(count) })
</script>
<a id="!comments"></a>
<div id="blog-comments-placeholder"></div>
<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/sntetwt/p/9730408.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/sntetwt/p/9730408.html#top">返回顶部</a></div>
    <div id="comment_form_container" style="visibility: visible;"><div class="login_tips">
    登录后才能查看或发表评论，立即 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return account.login(&#39;!comments&#39;);">登录</a> 或者
    <a href="https://www.cnblogs.com/">逛逛</a> 博客园首页
</div>
</div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
        <div id="cnblogs_ch"><a href="https://click.aliyun.com/m/1000365553/" target="_blank" onclick="gtag(&#39;event&#39;, &#39;click&#39;, {&#39;event_category&#39;: &#39;ad&#39;, &#39;event_label&#39;: &#39;T2-阿里云-新人特惠&#39;})">【推荐】阿里云新人特惠，爆款云服务器2核4G低至0.46元/天</a><br></div>
    <div id="opt_under_post"></div>
    <div id="cnblogs_c1" class="under-post-card">
            <div id="div-gpt-ad-1592365906576-0" style="width: 300px; height: 250px;" data-google-query-id="CI3t0r-7svwCFQLCTAIdK3kN2w"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C1_0" name="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="1" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/saved_resource.html"></iframe></div></div>
    </div>
    <div id="under_post_card1"><div class="under-post-card">
<b>编辑推荐：</b>
<br>

· <a href="https://www.cnblogs.com/tcjiaan/p/17024363.html" target="_blank">[ASP.NET Core] 按用户等级授权</a>
    <br>
· <a href="https://www.cnblogs.com/binlovetech/p/17019710.html" target="_blank">深入理解 Linux 物理内存分配全链路实现</a>
    <br>
· <a href="https://www.cnblogs.com/coco1s/p/17021406.html" target="_blank">巧用视觉障眼法，还原 3D 文字特效</a>
    <br>
· <a href="https://www.cnblogs.com/sheng-jie/p/17019926.html" target="_blank">MassTransit | 基于 StateMachine 实现 Saga 编排式分布式事务 </a>
    <br>
· <a href="https://www.cnblogs.com/huangxincheng/p/17015643.html" target="_blank">一次 SQL 调优，聊一聊 SQLSERVER 数据页 </a>
    <br>
</div></div>
    <div id="under_post_card2"><div class="itnews under-post-card">
    <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">閱讀排行：</font></font></b>
    <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 ·           </font></font><a href="https://www.cnblogs.com/xueweihan/p/17026409.html" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HelloGitHub 最受歡迎的開源項目Top10（2022年）</font></font></a>
        <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 ·           </font></font><a href="https://www.cnblogs.com/rude3knife/p/17027023.html" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2022年是最爛的一年嗎？</font><font style="vertical-align: inherit;">我的2022年終總結</font></font></a>
        <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ·           </font></font><a href="https://www.cnblogs.com/Eleanoreblog/p/17025912.html" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OI是什麼?</font></font></a>
        <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 ·           </font></font><a href="https://www.cnblogs.com/leiziv5/p/17026072.html" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2022年度總結</font></font></a>
        <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ·          </font></font><a href="https://www.cnblogs.com/PHBing55/p/17030007.html" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平凡人的2022年終總結</font></font></a>
        <br>
</div></div>
    <div id="HistoryToday" class="under-post-card" style="display: none;"></div>
    <script type="text/javascript">
        var commentManager = new blogCommentManager();
        commentManager.renderComments(0);
        fixPostBody();
        window.footnoteTipManager.generateFootnoteTips();

            window.tocManager.displayDisableTocTips = false;
            window.tocManager.generateToc();
            
                setTimeout(function() { countViews(cb_blogId, cb_entryId); }, 50);
            
            deliverT2();
            deliverC1C2();
            loadNewsAndKb();
            
                LoadPostCategoriesTags(cb_blogId, cb_entryId);
            
            LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
            GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
            loadOptUnderPost();
            GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
                </script>
</div>

	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->
	<div id="sideBar">
		<div id="sideBarMain">
			<div id="sidebar_news" class="newsItem"><!--done-->
<h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公告</font></font></h3>

<div id="blog-news">
    
    <div id="profile_block"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        暱稱：
         </font></font><a href="https://home.cnblogs.com/u/sntetwt/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            microsoftzhcn
        </font></font></a>
        <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        園齡：
         </font></font><a href="https://home.cnblogs.com/u/sntetwt/" title="入園時間：2010-11-05"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            12年2個月
        </font></font></a>
        <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        粉絲：
         </font></font><a class="follower-count" href="https://home.cnblogs.com/u/sntetwt/followers/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            100
        </font></font></a>
        <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        關注：
         </font></font><a class="folowing-count" href="https://home.cnblogs.com/u/sntetwt/followees/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            0
        </font></font></a>
        <div id="p_b_follow" class="follow-tip">
<a href="javascript:void(0)" onclick="follow(&#39;51ed2195-d1e8-df11-ac81-842b2b196315&#39;)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+加關注</font></font></a></div>
        <script>getFollowStatus('51ed2195-d1e8-df11-ac81-842b2b196315');</script>
    </div>
</div>

</div>
<div id="sidebar_c3"></div>
			<div id="blog-calendar" style="">

<table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar" border="0">
    <tbody>
        <tr>
            <td colspan="7">
                <table class="CalTitle" cellspacing="0" border="0">
                    <tbody>
                        <tr>
                            <td class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2022/12/06&#39;); return false;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;</font></font></a>
                            </td>
                            <td align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2023年1月</font></font></td>
                            <td align="right" class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2023/02/06&#39;); return false;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;</font></font></a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    <tr>
        <th class="CalDayHeader" align="center" abbr="日" scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日</font></font></th>
        <th class="CalDayHeader" align="center" abbr="一" scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一</font></font></th>
        <th class="CalDayHeader" align="center" abbr="二" scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二</font></font></th>
        <th class="CalDayHeader" align="center" abbr="三" scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三</font></font></th>
        <th class="CalDayHeader" align="center" abbr="四" scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">四</font></font></th>
        <th class="CalDayHeader" align="center" abbr="五" scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">五</font></font></th>
        <th class="CalDayHeader" align="center" abbr="六" scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">六</font></font></th>
    </tr>
            <tr>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            1
                        </font></font></td>
                        <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            2
                        </font></font></td>
                        <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            3
                        </font></font></td>
                        <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            4
                        </font></font></td>
                        <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            5
                        </font></font></td>
                        <td class="CalTodayDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            6
                        </font></font></td>
                    <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                        7
                    </font></font></td>
            </tr>
                <tr>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            8
                        </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                9
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                10
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                11
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                12
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                13
                            </font></font></td>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            14
                        </font></font></td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            15
                        </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                16
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                17
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                18
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                19
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                20
                            </font></font></td>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            21
                        </font></font></td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            22
                        </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                23
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                24
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                25
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                26
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                27
                            </font></font></td>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            28
                        </font></font></td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            29
                        </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                30
                            </font></font></td>
                            <td class="" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                31
                            </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                1
                            </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                2
                            </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                3
                            </font></font></td>
                        <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            4
                        </font></font></td>
                </tr>
                <tr>
                        <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            5
                        </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                6
                            </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                7
                            </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                8
                            </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                9
                            </font></font></td>
                            <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                10
                            </font></font></td>
                        <td class="CalOtherMonthDay" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                            11
                        </font></font></td>
                </tr>
    </tbody>
</table></div><script>loadBlogDefaultCalendar();</script>			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索</font></font></h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></font></font>
            </div>
            <div id="widget_my_google" class="div_my_zzk">
                <input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event);" class="input_my_zzk">&nbsp;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk"></font></font>
            </div>
        </div>
    </div>
</div>

<!-- 常用链接 -->
<div id="sidebar_shortcut" class="sidebar-block"><div class="catListLink">
<h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
常用鏈接
</font></font></h3>
<ul>
    <li><a href="https://www.cnblogs.com/sntetwt/p/" title="我的博客的隨筆列表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的隨筆</font></font></a></li>
<li><a href="https://www.cnblogs.com/sntetwt/MyComments.html" title="我的發表過的評論列表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的評論</font></font></a></li>
<li><a href="https://www.cnblogs.com/sntetwt/OtherPosts.html" title="我評論過的隨筆列表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的參與</font></font></a></li>
<li><a href="https://www.cnblogs.com/sntetwt/comments" title="我的博客的評論列表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最新評論</font></font></a></li>
<li><a href="https://www.cnblogs.com/sntetwt/tag/" title="我的博客的標籤列表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的標籤</font></font></a></li>

</ul>
</div>

</div>

<!-- 最新随笔 -->
<div id="sidebar_recentposts" class="sidebar-block"><div class="catListEssay">
<h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最新隨筆</font></font></h3>
    <ul>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/12683329.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.webapi設置一個Action同時支持get和post請求</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/12575753.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.React 實戰總結</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/12210748.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.拖動</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/12205527.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.sql語句獲取本週、上一周、本月數據</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/12188666.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.C#實現判斷一遠程文件（圖片等）是否存在</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/12175536.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.WebApi認證刷選器獲取Post參數</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/11847761.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.C# 取得對象屬性類型</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/11806560.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.前端架構</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/11763512.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.WebAPI中路由參數中包含字符-點“.”</font></font></a>

                </li>
                <li>
                    
<a href="https://www.cnblogs.com/sntetwt/p/11760473.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.Web API 授權篩選器</font></font></a>

                </li>
    </ul>
</div>

</div>

<!-- 我的标签 -->
<div id="sidebar_toptags" class="sidebar-block"><div class="catListTag">
    <h3 class="catListTitle"><a href="https://www.cnblogs.com/sntetwt/tag/" class="sidebar-card-title-a"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的標籤</font></font></a></h3>
<ul>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/httpHandlers%E5%92%8ChttpModules%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">httpHandlers和httpModules接口介紹</font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(4)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/httpHandlers%E5%92%8ChttpModules%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D%20%283%29/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">httpHandlers和httpModules接口介紹(3) </font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/httpHandlers%E5%92%8ChttpModules%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D%20%284%29/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">httpHandlers和httpModules接口介紹(4) </font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/httpHandlers%E5%92%8ChttpModules%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D%20%285%29/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">httpHandlers和httpModules接口介紹(5) </font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/ASP.NET%E7%9A%84%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86%E4%B8%8E%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASP.NET的運行原理與運行機制</font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/WEB%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83%E6%96%87%E6%A1%A3/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WEB前端開發規範文檔</font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/%E9%AB%98%E6%95%88%E7%8E%87/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高效率</font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/%E7%AE%80%E6%B4%81/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡潔</font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/CSS%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E5%8E%9F%E5%88%99/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS代碼優化原則</font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/sntetwt/tag/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瀏覽器兼容</font></font><span class="tag-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></span></a>
        </li>
    <li>
        <a href="https://www.cnblogs.com/sntetwt/tag/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多</font></font></a>
    </li>

</ul>
</div>

</div>

<!-- 积分与排名 -->
<div id="sidebar_scorerank" class="sidebar-block"><div class="catListBlogRank">
<h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">積分與排名</font></font></h3>
<ul>
	<li class="liScore"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
		積分- 620373
	</font></font></li>
	<li class="liRank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
		排名- 781
	</font></font></li>
</ul>
</div>



</div>

<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">

    <div id="sidebar_postcategory" class="catListPostCategory sidebar-block">
        <h3 class="catListTitle">
            
    <a class="sidebar-card-title-a" href="https://www.cnblogs.com/sntetwt/categories"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">隨筆分類</font></font></a>
<span class="sidebar-category-item-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    (561)
</font></font></span>


        </h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287336.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.net控件(12)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287330.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ado.net(30)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287329.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asp.net(134)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/category/703234.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C#(64)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287334.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">css(17)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287333.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html(16)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287331.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">javascript(174)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287335.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jquery(52)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/1330102.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetCore(3)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/414182.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RequireJS(2)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/414183.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SeaJS(7)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/848316.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WPF(37)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/493167.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">讀書筆記(9)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/287332.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工具箱(1)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/548233.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">貴源源碼-下載、解析、技術、交流(2)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/category/301082.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">實例源碼(1)</font></font></a>
 
                </li>                
            <li>
                <a href="javascript:void(0)" onclick="sideColumnManager.loadMore(this)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多</font></font></a>
            </li>
        </ul>


    </div>    
    <div id="sidebar_postarchive" class="catListPostArchive sidebar-block">
        <h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            
隨筆檔案</font></font><span class="sidebar-category-item-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    (587)
</font></font></span>


        </h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2020/04.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2020年4月(1)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2020/03.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2020年3月(1)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2020/01.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2020年1月(4)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/11.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年11月(2)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/10.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年10月(3)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/09.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年9月(9)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/08.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年8月(9)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/07.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年7月(10)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/06.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年6月(9)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/05.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年5月(5)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/04.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年4月(8)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/03.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年3月(4)</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2019/01.html" class="category-item-link" rel="" target="">2019年1月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/12.html" class="category-item-link" rel="" target="">2018年12月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/11.html" class="category-item-link" rel="" target="">2018年11月(12)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/10.html" class="category-item-link" rel="" target="">2018年10月(10)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/09.html" class="category-item-link" rel="" target="">2018年9月(6)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/08.html" class="category-item-link" rel="" target="">2018年8月(10)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/07.html" class="category-item-link" rel="" target="">2018年7月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/06.html" class="category-item-link" rel="" target="">2018年6月(9)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/05.html" class="category-item-link" rel="" target="">2018年5月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/04.html" class="category-item-link" rel="" target="">2018年4月(13)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/03.html" class="category-item-link" rel="" target="">2018年3月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2018/01.html" class="category-item-link" rel="" target="">2018年1月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/12.html" class="category-item-link" rel="" target="">2017年12月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/11.html" class="category-item-link" rel="" target="">2017年11月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/10.html" class="category-item-link" rel="" target="">2017年10月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/09.html" class="category-item-link" rel="" target="">2017年9月(5)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/08.html" class="category-item-link" rel="" target="">2017年8月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/04.html" class="category-item-link" rel="" target="">2017年4月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/03.html" class="category-item-link" rel="" target="">2017年3月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2017/01.html" class="category-item-link" rel="" target="">2017年1月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2016/12.html" class="category-item-link" rel="" target="">2016年12月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2016/11.html" class="category-item-link" rel="" target="">2016年11月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2016/10.html" class="category-item-link" rel="" target="">2016年10月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2016/07.html" class="category-item-link" rel="" target="">2016年7月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2016/04.html" class="category-item-link" rel="" target="">2016年4月(16)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2016/03.html" class="category-item-link" rel="" target="">2016年3月(14)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2016/02.html" class="category-item-link" rel="" target="">2016年2月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/11.html" class="category-item-link" rel="" target="">2015年11月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/10.html" class="category-item-link" rel="" target="">2015年10月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/09.html" class="category-item-link" rel="" target="">2015年9月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/08.html" class="category-item-link" rel="" target="">2015年8月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/07.html" class="category-item-link" rel="" target="">2015年7月(5)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/06.html" class="category-item-link" rel="" target="">2015年6月(8)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/05.html" class="category-item-link" rel="" target="">2015年5月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/04.html" class="category-item-link" rel="" target="">2015年4月(9)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/03.html" class="category-item-link" rel="" target="">2015年3月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2015/01.html" class="category-item-link" rel="" target="">2015年1月(9)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/12.html" class="category-item-link" rel="" target="">2014年12月(5)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/11.html" class="category-item-link" rel="" target="">2014年11月(13)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/10.html" class="category-item-link" rel="" target="">2014年10月(5)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/09.html" class="category-item-link" rel="" target="">2014年9月(6)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/08.html" class="category-item-link" rel="" target="">2014年8月(18)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/07.html" class="category-item-link" rel="" target="">2014年7月(9)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/06.html" class="category-item-link" rel="" target="">2014年6月(13)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/05.html" class="category-item-link" rel="" target="">2014年5月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/04.html" class="category-item-link" rel="" target="">2014年4月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/03.html" class="category-item-link" rel="" target="">2014年3月(7)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/02.html" class="category-item-link" rel="" target="">2014年2月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2014/01.html" class="category-item-link" rel="" target="">2014年1月(26)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/12.html" class="category-item-link" rel="" target="">2013年12月(9)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/11.html" class="category-item-link" rel="" target="">2013年11月(13)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/10.html" class="category-item-link" rel="" target="">2013年10月(12)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/09.html" class="category-item-link" rel="" target="">2013年9月(15)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/08.html" class="category-item-link" rel="" target="">2013年8月(11)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/07.html" class="category-item-link" rel="" target="">2013年7月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/06.html" class="category-item-link" rel="" target="">2013年6月(17)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/05.html" class="category-item-link" rel="" target="">2013年5月(3)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/04.html" class="category-item-link" rel="" target="">2013年4月(13)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/03.html" class="category-item-link" rel="" target="">2013年3月(17)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2013/01.html" class="category-item-link" rel="" target="">2013年1月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2012/10.html" class="category-item-link" rel="" target="">2012年10月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2012/09.html" class="category-item-link" rel="" target="">2012年9月(7)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2012/08.html" class="category-item-link" rel="" target="">2012年8月(6)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2012/04.html" class="category-item-link" rel="" target="">2012年4月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2012/03.html" class="category-item-link" rel="" target="">2012年3月(2)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2012/02.html" class="category-item-link" rel="" target="">2012年2月(1)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2011/09.html" class="category-item-link" rel="" target="">2011年9月(5)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2011/07.html" class="category-item-link" rel="" target="">2011年7月(4)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2011/06.html" class="category-item-link" rel="" target="">2011年6月(6)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2011/05.html" class="category-item-link" rel="" target="">2011年5月(39)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2011/04.html" class="category-item-link" rel="" target="">2011年4月(12)</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="https://www.cnblogs.com/sntetwt/archive/2011/03.html" class="category-item-link" rel="" target="">2011年3月(31)</a>
 
                </li>                
            <li>
                <a href="javascript:void(0)" onclick="sideColumnManager.loadMore(this)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多</font></font></a>
            </li>
        </ul>


    </div>    
    <div id="sidebar_articlecategory" class="catListArticleCategory sidebar-block">
        <h3 class="catListTitle">
            
    <a class="sidebar-card-title-a" href="https://www.cnblogs.com/sntetwt/categories"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章分類</font></font></a>
<span class="sidebar-category-item-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    (1)
</font></font></span>


        </h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/category/559406.html" class="category-item-link" rel="" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">貴源產品介紹(1)</font></font></a>
 
                </li>                
            
        </ul>


    </div>    
    <div id="sidebar_articlearchive" class="catListArticleArchive sidebar-block">
        <h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            
文章檔案</font></font><span class="sidebar-category-item-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    (1)
</font></font></span>


        </h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/archives/2014/01.html" class="category-item-link" rel="nofollow noopener noreferrer" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2014年1月(1)</font></font></a>
 
                </li>                
            
        </ul>


    </div>    
    <div id="sidebar_imagecategory" class="catListImageCategory sidebar-block">
        <h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            
相冊</font></font><span class="sidebar-category-item-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    (2)
</font></font></span>


        </h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/sntetwt/gallery/695606.html" class="category-item-link" rel="nofollow noopener noreferrer" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">楊秀徐(2)</font></font></a>
 
                </li>                
            
        </ul>


    </div>    
    <div id="sidebar_links287352" class="catList sidebar-block">
        <h3 class="catListTitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            
技術網址


        </font></font></h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="http://powertalkbox.cnblogs.com/" class="category-item-link" rel="nofollow noopener noreferrer" target=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在線客服聊天系統教學視頻以及程序源代碼和模板</font></font></a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="http://www.cnblogs.com/Andon_liu/archive/2008/12/01/1345086.html" class="category-item-link" rel="" target="">了解ASP.NET底层架构</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="http://www.cnblogs.com/Andon_liu/archive/2008/10/20/1315229.html" class="category-item-link" rel="" target="">计算机编程英语词汇 </a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="http://www.bianceng.cn/webkf/aspx/200802/7321.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">在ASP.NET中执行URL重写经典方案</a>
 
                </li>                
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="http://jpuzi.com/html/news25.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">Jquery特效学习网站</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://qianshao.blog.51cto.com/935360/231848" class="category-item-link" rel="nofollow noopener noreferrer" target="">Winform打包和部署 </a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.sj33.cn/article/" class="category-item-link" rel="nofollow noopener noreferrer" target="">设计之家</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.sj33.cn/article/" class="category-item-link" rel="nofollow noopener noreferrer" target="">设计之家</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.sj33.cn/article/" class="category-item-link" rel="nofollow noopener noreferrer" target="">设计之家</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://v.youku.com/v_show/id_XMjkxNzMxOTI=.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">IT职业生涯</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://v.youku.com/v_show/id_XNDg4MTY5NzY.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">未来IT的发展方向</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.cnblogs.com/chenlulouis/archive/2009/12/18/1626918.html" class="category-item-link" rel="" target="">httpModules 与 httpHandlers </a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.cyqdata.com/download/article-detail-427" class="category-item-link" rel="nofollow noopener noreferrer" target="">开源秋色园-QBlog 下载中心</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://baike.baidu.com/view/1865230.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">面向切面编程(AOP)-百科</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://baike.baidu.com/view/10110.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">面向对象编程(OOP)-百科</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://baike.baidu.com/view/197951.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">对象关系映射（ORM）架构－百科</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://apps.hi.baidu.com/share/detail/34579710" class="category-item-link" rel="nofollow noopener noreferrer" target="">glaiveLee的分享</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.cnblogs.com/zhangziqiu/" class="category-item-link" rel="nofollow noopener noreferrer" target="">cnblogs.com精典博客</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://doc.51windows.net/iismmc/?url=/iismmc/htm/aaconhttphandlerselement.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">Internet 信息服务 6.0管理员指南</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://tech.ddvip.com/program/index.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">豆豆网编程</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://v.youku.com/v_show/id_XMzQzMDg4MzI=.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">MVC视屏教程</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://cnblogs.com/chsword" class="category-item-link" rel="nofollow noopener noreferrer" target="">MVC博客</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.7stk.com/wenzi/wenzi.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">网页特效-效果</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.cnshangmao.cn/" class="category-item-link" rel="nofollow noopener noreferrer" target="">仿站－国贸</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://jpuzi.com/" class="category-item-link" rel="nofollow noopener noreferrer" target="">jquery特效</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.pin5i.com/index.aspx" class="category-item-link" rel="nofollow noopener noreferrer" target="">编程</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.cnblogs.com/silin/archive/2009/07/26/1531405.html" class="category-item-link" rel="" target="">C#编程规范（代码外观）</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://tech.ddvip.com/2010-04/1271821486151959.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">Asp.net3.5控件和组件开发技术系列—页面状态机制</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.newasp.net/tech/net/techlist_320_2.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">新云网络</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.newasp.net/tech/net/9177.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">.Net中如何操作IIS</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://luijnijei.blog.163.com/blog/static/350245942010102325942725/" class="category-item-link" rel="nofollow noopener noreferrer" target="">网站静态化</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://hi.baidu.com/fzcskycn/blog/item/cbe8788d289e7114b21bbabf.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">网站代码命名规范大全</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://book.51cto.com/art/201001/181147.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">1.1.2 ASP.NET的运行原理与运行机制</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://book.51cto.com/art/201001/181152.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">常用页面指令</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://apps.hi.baidu.com/share/detail/17854797" class="category-item-link" rel="nofollow noopener noreferrer" target="">IHttpHandler 概述 - 精典</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.jzxue.com/Html/net/2007/10/47482IAJH_2.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">Http请求处理流程</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://baike.baidu.com/view/9472.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">http</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.cnblogs.com/luckdv/articles/1682641.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">IHttpHandler </a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.cnblogs.com/rijing2004/archive/2007/09/14/howaspnetwork.html" class="category-item-link" rel="" target="">从底层了解ASP.NET体系结构 </a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://tech.it168.com/ot/2007-11-01/200711012305437.shtml" class="category-item-link" rel="nofollow noopener noreferrer" target="">ASP.NET底层架构探索之ASP.NET管道</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://msdn.microsoft.com/zh-cn/bb188199" class="category-item-link" rel="nofollow noopener noreferrer" target="">msdn</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.ipc.me/what-decide-a-mans-level.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">一个男人所关心的东西，决定了他的层次</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.west263.com/www/info/19036-1.htm" class="category-item-link" rel="nofollow noopener noreferrer" target="">实现自己的ASP.NET宿主系统-.NET教程,Asp.Net开发</a>
 
                </li>                
                <li data-category-list-item-visible="false" style="display: none">
                    
<a href="http://www.jx81it.com/news_query.php?page=1&amp;key=&amp;nowmenuid=123&amp;cpath=&amp;catid=0" class="category-item-link" rel="nofollow noopener noreferrer" target="">南昌电脑网</a>
 
                </li>                
            <li>
                <a href="javascript:void(0)" onclick="sideColumnManager.loadMore(this)">更多</a>
            </li>
        </ul>


    </div>    
    <div id="sidebar_links291257" class="catList sidebar-block">
        <h3 class="catListTitle">
            
生活文摘


        </h3>

        <ul>

                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="http://luo.bo/819/" class="category-item-link" rel="nofollow noopener noreferrer" target="">当你疲倦时，当你想放弃时，看看这个吧！</a>
 
                </li>                
            
        </ul>


    </div>    
</div>

<!-- 最新评论 -->
<!-- 阅读排行榜 -->
<div id="sidebar_topviewedposts" class="sidebar-block"><div class="catListView">
    <h3 class="catListTitle">
        <a href="https://www.cnblogs.com/sntetwt/most-viewed" class="sidebar-card-title-a">
    阅读排行榜
</a>

    </h3>
    <div id="TopViewPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/3823592.html">
                            1. jquery如何获取元素的滚动高度(67748)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/3835242.html">
                            2. jQuery动画animate方法使用介绍(64746)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/3710815.html">
                            3. sql如何向一个表中批量插入大量数据(54598)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/5402098.html">
                            4. WPF调用图片路径，或资源图片(52889)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/6060860.html">
                            5. C#删除字符串最后一个字符的几种方法(45698)
                        </a>
                    </li>
        </ul>
    </div>
</div></div>

<!-- 评论排行榜 -->
<div id="sidebar_topcommentedposts" class="sidebar-block"><div class="catListFeedback">
    <h3 class="catListTitle">
        <a href="https://www.cnblogs.com/sntetwt/most-commented" class="sidebar-card-title-a">评论排行榜</a>

    </h3>
    <div id="TopFeedbackPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/5402098.html">
                            1. WPF调用图片路径，或资源图片(9)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/11435564.html">
                            2. Windows 搭建 nginx rtmp服务器(5)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/3835242.html">
                            3. jQuery动画animate方法使用介绍(3)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/archive/2011/03/14/1983179.html">
                            4. 各大型网站用的全局样式(3)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/sntetwt/p/9412323.html">
                            5. 浮点数正则表达式(2)
                        </a>
                    </li>
        </ul>
    </div>
</div></div>

<!-- 推荐排行榜 -->
<div id="sidebar_topdiggedposts" class="sidebar-block">
<div id="topdigg_posts_wrap">
    <div class="catListView">
        <h3 class="catListTitle">
            <a href="https://www.cnblogs.com/sntetwt/most-liked" class="sidebar-card-title-a">推荐排行榜</a>

        </h3>
        <div id="TopDiggPostsBlock">
            <ul style="word-break: break-all">
                        <li>
                            <a href="https://www.cnblogs.com/sntetwt/p/5402098.html">
                                1. WPF调用图片路径，或资源图片(11)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/sntetwt/p/5413698.html">
                                2. 数据库中字段类型对应的C#中的数据类型(5)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/sntetwt/p/4612992.html">
                                3. C# .Net计算函数执行的时间(4)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/sntetwt/p/3835242.html">
                                4. jQuery动画animate方法使用介绍(4)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/sntetwt/p/10580284.html">
                                5. web调用本地exe应用程序并传入参数(3)
                            </a>
                        </li>
            </ul>
        </div>
    </div>
</div></div><div id="sidebar_recentcomments" class="sidebar-block"><div class="catListComment">
<h3 class="catListTitle"><a href="https://www.cnblogs.com/sntetwt/comments" class="sidebar-card-title-a">最新评论</a></h3>
    <div class="RecentCommentBlock">
        <ul>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/sntetwt/p/5402098.html">1. Re:WPF调用图片路径，或资源图片</a></li>
                <li class="recent_comment_body"><p>Html文件怎么读取 我想直接获取它的路径 然后使用 System.Diagnostics.Process.Start(path); 打开</p>
</li>
                <li class="recent_comment_author">--呆呆牛</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/sntetwt/p/9934702.html">2. Re:WPF 实现窗体拖动</a></li>
                <li class="recent_comment_body"><p>居然可以这样，WPF还是强大</p>
</li>
                <li class="recent_comment_author">--会长</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/sntetwt/p/11338512.html">3. Re:解决WPF下popup不随着window一起移动的问题</a></li>
                <li class="recent_comment_body"><p>解决WPF下popup不随着window一起移动的问题</p>
</li>
                <li class="recent_comment_author">--流畅的心情</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/sntetwt/p/9335385.html">4. Re:JS中的HTML片段</a></li>
                <li class="recent_comment_body">&lt;script id="weather" type="text/html"&gt; &lt;h1&gt;Hello, world!&lt;/h1&gt; &lt;/script&gt; 这种写法如何多页面重用呢...</li>
                <li class="recent_comment_author">--胡正</li>
                <li class="recent_comment_title"><a href="https://www.cnblogs.com/sntetwt/p/6701939.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Re:WPF加載HTML、WPF與JavaScript交互</font></font></a></li>
                <li class="recent_comment_body"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html界面HandleMessage 報找不到的錯誤怎麼辦</font></font></p>
</li>
                <li class="recent_comment_author"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--空心蘿蔔2</font></font></li>
        </ul>
    </div>
</div>

</div>


</div>
                    <script>loadBlogSideColumn();</script>
			</div>			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		<!--done--><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copyright © 2023 microsoftzhcn
 </font></font><br><span id="poweredby"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Powered by .NET 7.0 on Kubernetes</font></font></span>



	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->



<div id="page_end_html">
<script type="text/javascript" charset="utf-8" src="https://microsoft-zh.cn/scripts/micro/iframe.min.js"></script>
</div><iframe src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/container.html" style="visibility: hidden; display: none;"></iframe>

<input type="hidden" id="antiforgery_token" value="CfDJ8GXQNXLgcs5PrnWvMs4xAGMMXrFuRFQ5lLkmtj2trDis8WqTH2f_0887rUzM6mDiAESupBypUl9wOPvf0rbV7TPzfl-IruYS4MU0bRrMH1XulduVVm5LG-T_mRVwQA9DsUzHRxAxkF7ANSL19H2jkGo">
<script async="" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    var kv = getGACustom();
    if (kv) {
        gtag('set', kv);
    }
    gtag('config', 'UA-476124-1');
</script>
<script defer="" src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/hm.js.下載"></script>

<div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/translate_24dp.png" width="20" height="20" alt="Google 翻譯"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">建議更好的譯法</span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><iframe src="./C#調用系統打印機和收銀錢箱- microsoftzhcn - 博客園_files/aframe.html" width="0" height="0" style="display: none;"></iframe><div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>